(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59135,       1511]
NotebookOptionsPosition[     56067,       1437]
NotebookOutlinePosition[     56407,       1452]
CellTagsIndexPosition[     56364,       1449]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fileName", " ", "=", " ", 
   RowBox[{"\"\<results/nv_center_simulation\>\"", "  ", "<>", " ", 
    RowBox[{"StringReplace", "[", " ", 
     RowBox[{
      RowBox[{"DateString", "[", "\"\<ISODateTime\>\"", "]"}], ",", " ", 
      RowBox[{"\"\<:\>\"", " ", "\[Rule]", " ", "\"\<.\>\""}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.710804308136487*^9, 3.710804308444024*^9}, {
   3.710851376716381*^9, 3.7108513846410437`*^9}, 
   3.71087924794349*^9},ExpressionUUID->"1d14f45f-75ef-4245-994f-\
5c3c47751f62"],

Cell[CellGroupData[{

Cell["NV-Centre simulation", "Title",
 CellChangeTimes->{{3.711156360346736*^9, 
  3.711156367296481*^9}},ExpressionUUID->"d49ea734-8d64-4325-929d-\
d380436e71a0"],

Cell[CellGroupData[{

Cell["Initialisation", "Chapter",
 CellChangeTimes->{{3.7111563536716957`*^9, 
  3.7111563556790543`*^9}},ExpressionUUID->"5e946c75-9857-49e7-8818-\
3184363a9c1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Simulation", " ", "parameters"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pulseAmplitude", " ", "=", " ", 
     RowBox[{"7", "*", 
      SuperscriptBox["10", "6"]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulsePhase", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tStart", " ", "=", " ", "0"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "s", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tEnd", " ", "=", " ", 
     RowBox[{"2", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "s", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pulseFreqStart", " ", "=", " ", 
      RowBox[{"500", "*", 
       SuperscriptBox["10", "6"]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pulseFreqEnd", " ", "=", " ", 
      RowBox[{"530", "*", 
       SuperscriptBox["10", "7"]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"[", "Hz", "]"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"pulseFreqStart", " ", "=", " ", 
      RowBox[{"1.369", "*", 
       SuperscriptBox["10", "9"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pulseFreqEnd", "=", 
      RowBox[{"1.5", "*", 
       SuperscriptBox["10", "9"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pulseFreqStart", " ", "=", " ", 
      RowBox[{"1.43", "*", 
       SuperscriptBox["10", "9"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pulseFreqEnd", "=", 
      RowBox[{"1.4331", "*", 
       SuperscriptBox["10", "9"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"pulseFreqStart", " ", "=", " ", 
      RowBox[{"7.16", "*", 
       SuperscriptBox["10", "9"]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pulseFreqEnd", " ", "=", " ", 
      RowBox[{"7.22", "*", 
       SuperscriptBox["10", "8"]}]}], ";"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"[", "Hz", "]"}], " ", "*)"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulseFreqStart", " ", "=", " ", 
     RowBox[{"2.867", "*", 
      SuperscriptBox["10", "9"]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulseFreqEnd", " ", "=", " ", 
     RowBox[{"2.881", "*", 
      SuperscriptBox["10", "9"]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "Hz", "]"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"calculations", " ", "=", " ", "15"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulseFreqStep", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"pulseFreqEnd", " ", "-", " ", "pulseFreqStart"}], ")"}], " ", 
      "/", " ", "calculations"}]}], ";"}], " "}]}]], "Input",
 CellChangeTimes->{
  3.710806009149169*^9, {3.7108060566239357`*^9, 3.7108060752750874`*^9}, {
   3.710806143724998*^9, 3.710806318226289*^9}, {3.710812460244783*^9, 
   3.710812462818932*^9}, {3.7108127241709423`*^9, 3.7108127245205584`*^9}, 
   3.71081590826723*^9, {3.7108238758294067`*^9, 3.7108238825293713`*^9}, {
   3.7108239943052273`*^9, 3.710824032705736*^9}, {3.710837065511478*^9, 
   3.7108370792110653`*^9}, {3.710837287112187*^9, 3.710837311411633*^9}, 
   3.710850728639022*^9, {3.7108508709140263`*^9, 3.7108509316150846`*^9}, {
   3.710850997790325*^9, 3.7108511056412487`*^9}, 3.710851256449295*^9, {
   3.710851599293901*^9, 3.710851602542963*^9}, {3.710851841043202*^9, 
   3.710851877968454*^9}, {3.7108814322324543`*^9, 3.7108814330430517`*^9}, {
   3.710881870164485*^9, 3.710881884134583*^9}, {3.710975563446197*^9, 
   3.71097561237866*^9}, {3.710978225559168*^9, 3.710978235484942*^9}, {
   3.710978291234782*^9, 3.710978383535391*^9}, {3.710981799778274*^9, 
   3.71098180230372*^9}, {3.710982583036131*^9, 3.710982586110607*^9}, {
   3.7109994816473007`*^9, 3.7109994941218157`*^9}, {3.711002946488125*^9, 
   3.711002962938561*^9}, {3.7110059921005487`*^9, 3.711006005750245*^9}, {
   3.71101057050115*^9, 3.7110105753517733`*^9}, {3.711010622325823*^9, 
   3.711010670225429*^9}, {3.711055674994376*^9, 3.711055695067766*^9}, 
   3.711055741795199*^9, {3.711142857510189*^9, 3.711142858536261*^9}, {
   3.71114345938796*^9, 3.711143461412425*^9}, 3.7111560186954937`*^9, {
   3.711672847226099*^9, 3.711672851782399*^9}, {3.7116745548725367`*^9, 
   3.711674555447274*^9}},ExpressionUUID->"bd9c4d79-b9a7-4f4d-840d-\
f4c5f5825600"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Constants", " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]N", " ", "=", " ", 
     RowBox[{"19.331", "*", 
      SuperscriptBox["10", "6"]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Gyromagnetic", " ", "ratio", " ", "for", 
     SuperscriptBox[" ", "14"], 
     RowBox[{"N", " ", "[", 
      RowBox[{
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox["T", 
        RowBox[{"-", "1"}]]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]e", " ", "=", " ", 
     RowBox[{"1.7609", "*", 
      SuperscriptBox["10", "11"]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Gyromagnetic", " ", "ratio", " ", "for", " ", "e"}], "-", " ", 
     RowBox[{"[", 
      RowBox[{"rad", " ", 
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox["T", 
        RowBox[{"-", "1"}]]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B0", " ", "=", 
     RowBox[{"0", "*", "513", " ", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"DC", " ", "Applied", " ", 
      RowBox[{"field", " ", "[", "T", "]"}]}], " ", "*)"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]s", "=", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "\[Gamma]e"}], " ", "B0"}], 
      RowBox[{"2", "\[Pi]"}]]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]I", "=", 
     FractionBox[
      RowBox[{"\[Gamma]N", " ", "B0"}], 
      RowBox[{"2", "\[Pi]"}]]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ahf", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "2.16"}], "*", 
      SuperscriptBox["10", "6"]}]}], " ", ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Hyperfine", " ", 
     RowBox[{"interaction", " ", "[", "Hz", "]"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dzfs", " ", "=", " ", 
     RowBox[{"2870", "*", 
      SuperscriptBox["10", "6"]}]}], " ", ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Zero", "-", "field", "-", 
     RowBox[{"splitting", " ", "for", " ", "electron", " ", 
      RowBox[{"triplet", " ", "[", "Hz", "]"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pzfs", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "4.95"}], "*", 
      SuperscriptBox["10", "6"]}]}], " ", ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Zero", "-", "field", "-", 
     RowBox[{"splitting", " ", "for", 
      SuperscriptBox[" ", "14"], 
      RowBox[{"N", " ", "[", "Hz", "]"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Axyhf", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "2.1"}], "*", 
      SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Azhf", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "2.16"}], "*", 
      SuperscriptBox["10", "6"]}]}], " ", ";"}], " "}]}]], "Input",
 CellChangeTimes->{{3.710803700158299*^9, 3.710803705157847*^9}, {
   3.710803763033595*^9, 3.710803782008196*^9}, {3.710806321001631*^9, 
   3.7108063795519257`*^9}, 3.7108154002393503`*^9, {3.710978264509679*^9, 
   3.71097826473475*^9}, {3.710981793378274*^9, 3.710981793854289*^9}, {
   3.7109966571936827`*^9, 3.710996658118456*^9}, 3.7111429392614803`*^9, {
   3.7116752025212727`*^9, 
   3.711675203168651*^9}},ExpressionUUID->"db2dbe06-37cf-4783-a3f7-\
4df778d19dae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Triplet", " ", "spin", " ", "operators"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Sx", " ", "=", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Sqrt", "[", "2", "]"}]], 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"{", "  ", 
         RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}], " ", ",", " ", 
        RowBox[{"{", " ", 
         RowBox[{"1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "1", ",", " ", "0"}], " ", "}"}]}], " ", 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sy", " ", "=", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        RowBox[{"Sqrt", "[", "2", "]"}], " ", "I"}]], 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"{", "  ", 
         RowBox[{"0", ",", " ", 
          RowBox[{"-", "1"}], ",", " ", "0"}], "}"}], " ", ",", " ", 
        RowBox[{"{", " ", 
         RowBox[{"1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", 
          RowBox[{"-", "1"}], ",", " ", "0"}], " ", "}"}]}], " ", "}"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sy", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          FractionBox["\[ImaginaryI]", 
           SqrtBox["2"]]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]], ",", "0", ",", 
         RowBox[{"-", 
          FractionBox["\[ImaginaryI]", 
           SqrtBox["2"]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]], ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sz", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "0", ",", " ", "0"}], " ", "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eye", " ", "=", " ", 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Electron", " ", "triplet", " ", "operators"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eSx", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"Sx", ",", " ", "eye"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"eSz", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"Sz", ",", " ", "eye"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"eSy", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"Sy", ",", " ", "eye"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"N14", " ", "operators"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ix", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"eye", ",", " ", "Sx"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Iy", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"eye", ",", " ", "Sy"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Iz", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"eye", ",", " ", "Sz"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710803813041401*^9, 3.7108038444336233`*^9}, {
  3.71080387890902*^9, 3.710803910408915*^9}, {3.710804180585863*^9, 
  3.710804260337324*^9}, {3.71080641837753*^9, 3.710806476202467*^9}, {
  3.71080650842901*^9, 3.710806547102943*^9}, {3.7108240490812597`*^9, 
  3.710824058280965*^9}, {3.711675227545929*^9, 3.711675249704639*^9}, {
  3.711675632748151*^9, 
  3.711675635381886*^9}},ExpressionUUID->"2db4cba3-a1df-42cc-8c1f-\
edcdc856c65d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Setup", " ", "Hamiltonian"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Hhf", "=", "  ", 
     RowBox[{"Ahf", " ", 
      RowBox[{"eSz", " ", ".", " ", "Iz"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Secular", " ", "approximation"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hhf", "=", " ", 
     RowBox[{"2", "\[Pi]", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Axyhf", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"eSx", ".", "Ix"}], " ", "+", " ", 
           RowBox[{"eSy", ".", "Iy"}]}], " ", ")"}]}], " ", "+", " ", 
        RowBox[{"Azhf", " ", 
         RowBox[{"eSz", " ", ".", " ", "Iz"}]}]}], ")"}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hnv", " ", "=", "  ", 
     RowBox[{
      RowBox[{"2", "\[Pi]", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"Dzfs", " ", 
          RowBox[{"eSz", ".", "eSz"}]}], "  ", "+", " ", 
         RowBox[{"\[Omega]s", " ", "eSz"}], " ", "+", " ", 
         RowBox[{"Pzfs", "  ", 
          RowBox[{"Iz", ".", "Iz"}]}], " ", "-", " ", 
         RowBox[{"\[Omega]I", " ", "Iz"}]}], ")"}]}], " ", "+", " ", 
      "Hhf"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hcop", " ", "=", " ", 
     RowBox[{"2", "\[Pi]", " ", "pulseAmplitude", "  ", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"Sx", ",", " ", "Sx"}], "]"}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Hc", "[", "t_", "]"}], ":=", " ", 
     RowBox[{"Hcop", " ", 
      RowBox[{"Sin", "[", " ", 
       RowBox[{
        RowBox[{"2", "\[Pi]", " ", "pulseFreq", " ", "t"}], " ", "+", " ", 
        "pulsePhase"}], " ", "]"}]}]}], "  ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H", "[", "t_", "]"}], " ", ":=", " ", 
    RowBox[{"Hnv", "+", " ", 
     RowBox[{"Hc", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"systemSize", " ", "=", " ", 
     RowBox[{"Length", "[", 
      RowBox[{"H", "[", "0", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"comments", " ", "=", " ", 
     RowBox[{"StringRiffle", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "\"\<Pulse that acts on both nuclear spin and electron spin\>\"", ",",
          "\[IndentingNewLine]", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<B0=``T\>\"", ",", "B0"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<Frequency Resolution=``Hz\>\"", ",", " ", "pulseFreqStep"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<Pulse amplitude=``Hz\>\"", ",", " ", "pulseAmplitude"}], 
          "]"}]}], "\[IndentingNewLine]", "}"}], ",", " ", "\"\<. \>\""}], 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.710804314474235*^9, 3.710804325611812*^9}, {
   3.710804528737977*^9, 3.710804528988124*^9}, 3.7108059713753767`*^9, 
   3.710806393726984*^9, {3.710806592828232*^9, 3.710806595103409*^9}, {
   3.71080682862997*^9, 3.710806846505134*^9}, {3.710881199929245*^9, 
   3.7108812319129477`*^9}, {3.710881267076969*^9, 3.710881354978258*^9}, {
   3.71088158582417*^9, 3.7108815876256227`*^9}, {3.710881648021428*^9, 
   3.710881751765052*^9}, {3.7109819613552217`*^9, 3.710982088506267*^9}, {
   3.710982190332514*^9, 3.710982231532476*^9}, {3.710982306758369*^9, 
   3.71098246166004*^9}, {3.710982498660706*^9, 3.710982534510517*^9}, {
   3.7110028887630444`*^9, 3.71100289071318*^9}, {3.7111434531639643`*^9, 
   3.711143454611973*^9}, {3.71167521587142*^9, 3.71167521633046*^9}, 
   3.711677263173834*^9, {3.7116780438143053`*^9, 3.711678058664912*^9}, {
   3.711680229176059*^9, 
   3.711680235097303*^9}},ExpressionUUID->"6de995e6-fce7-4776-aa7a-\
d0e71c36c4d2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Setup", " ", "Density", " ", "matrix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"density", " ", "=", " ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"i", ",", " ", "j"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", "systemSize"}], "}"}]}], 
      "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"density", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"density", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", " ", 
      
      RowBox[{"{", 
       RowBox[{"j", ",", " ", 
        RowBox[{"i", "+", "1"}], ",", " ", "systemSize"}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"density", " ", "//", " ", "MatrixForm"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.710804535788083*^9, 3.7108045583173437`*^9}, {
  3.710804617464055*^9, 3.710804622515006*^9}, {3.7108053621696978`*^9, 
  3.710805362969448*^9}, {3.710805470720196*^9, 3.7108054709451427`*^9}, {
  3.710805899223364*^9, 3.71080594477358*^9}, {3.710806806405459*^9, 
  3.710806864456637*^9}, {3.710807003456621*^9, 
  3.710807003856599*^9}},ExpressionUUID->"13606bea-4877-4b60-974a-\
58a1ea9a83f5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "4"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "3"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "4"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "4"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "4"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "4"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "5"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "5"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "5"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "5"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"5", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"6", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"6", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"6", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"6", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"5", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"6", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"7", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"7", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"7", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"5", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"6", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"7", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"8", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"8", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"5", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"6", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"7", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"8", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"9", ",", "9"}], "]"}], "[", "t", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.710805904210074*^9, 3.7108059183380957`*^9}, 
   3.710806652281618*^9, {3.710806849300684*^9, 3.7108068648125277`*^9}, 
   3.710807547108816*^9, 3.710811807846637*^9, 3.710812729095531*^9, 
   3.710814132476225*^9, 3.710814170012809*^9, 3.710815438355691*^9, 
   3.710815911466321*^9, 3.71083733941352*^9, 3.7108373968374977`*^9, 
   3.710851414119883*^9, 3.710881369304091*^9, {3.7108818097963457`*^9, 
   3.7108818214469833`*^9}, 3.710881888570239*^9, 3.7109437694159613`*^9, {
   3.710978397815897*^9, 3.710978410612612*^9}, 3.710982598724537*^9, 
   3.71099666456656*^9, 3.7109995126676207`*^9, 3.7110030063936367`*^9, 
   3.711006009230526*^9, 3.7110106994374313`*^9, 3.711054556555934*^9, 
   3.711055699585916*^9, 3.711055744033495*^9, 3.711069736567005*^9, 
   3.711672854671269*^9, 3.7116745588681507`*^9, 3.711675252807611*^9, 
   3.711675641372735*^9, 3.711677333277377*^9, 3.711678062078927*^9, 
   3.7116803812215843`*^9},ExpressionUUID->"790a28d2-c144-47ca-9228-\
543a23c2c9e8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "initial", " ", "state", " ", "of", " ", "system"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"es", " ", "=", " ", 
     RowBox[{"Eigensystem", "[", "Hnv", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"groundState", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"es", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"es", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"es", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "}"}], " ", "//", " ",
       "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"density0", " ", "=", " ", 
     RowBox[{"groundState", " ", ".", " ", 
      RowBox[{"ConjugateTranspose", "[", "groundState", "]"}]}]}], " ", ";"}],
    "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.710806998725523*^9, 3.710807044031006*^9}, {
   3.710807078232047*^9, 3.710807373960236*^9}, 3.7108075535347013`*^9, {
   3.710812006866643*^9, 3.7108120761414757`*^9}, {3.7108818041300507`*^9, 
   3.710881805465757*^9}},ExpressionUUID->"bf453454-d952-4e64-ba3b-\
1f333bce6a5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "master", " ", "equation"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eqnTotal", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ImaginaryI]", "  ", 
        RowBox[{"D", "[", " ", 
         RowBox[{"density", ",", " ", "t"}], "]"}]}], " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", "t", "]"}], ".", "density"}], " ", "-", " ", 
         RowBox[{"density", ".", 
          RowBox[{"H", "[", "t", "]"}]}]}], ")"}]}], " ", "//", " ", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqns", " ", "=", " ", 
     RowBox[{
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"eqnTotal", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "i", ",", " ", "systemSize"}], "}"}]}], "]"}],
       " ", "//", " ", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diffeqs", " ", "=", " ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eqns", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "eqns", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funcs", " ", "=", 
     RowBox[{
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"density", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "i", ",", " ", "systemSize"}], "}"}]}], "]"}],
       " ", "//", " ", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialStateEqs", " ", "=", "  ", 
     RowBox[{
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Rho]", "[", 
           RowBox[{"i", ",", " ", "j"}], "]"}], "[", "0", "]"}], " ", 
         "\[Equal]", " ", 
         RowBox[{"density0", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "i", ",", " ", "systemSize"}], "}"}]}], "]"}],
       "  ", "//", " ", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"diffeqs", ",", " ", "initialStateEqs"}], " ", "}"}], " ", "//",
       " ", "Flatten"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710806678603804*^9, 3.710806714929104*^9}, {
   3.710806896356563*^9, 3.710806903280654*^9}, {3.710806934355884*^9, 
   3.710806968005375*^9}, {3.7108073881839542`*^9, 3.7108074222838917`*^9}, {
   3.7108075593109922`*^9, 3.7108075601851673`*^9}, {3.710807635910696*^9, 
   3.710807660261065*^9}, {3.7108077074614687`*^9, 3.7108077113360043`*^9}, {
   3.71080774633669*^9, 3.710807751061191*^9}, 
   3.711675580854319*^9},ExpressionUUID->"31405b0b-2958-465e-b2c3-\
9472ed0f9157"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Perform", " ", "simulation"}], " ", "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Store", " ", "T0", " ", "probability", " ", "data", " ", "for", " ", 
     "each", " ", "frequency"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"spin0vec", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", " ", 
       RowBox[{"{", "1", "}"}], ",", " ", 
       RowBox[{"{", "0", "}"}]}], " ", "}"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"tic", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"count", " ", "=", " ", "1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710808082551094*^9, 3.710808192489008*^9}, {
   3.710811730838995*^9, 3.7108117649394493`*^9}, {3.710811798664497*^9, 
   3.710811832839912*^9}, {3.710811947840746*^9, 3.710811951315729*^9}, {
   3.710811992365878*^9, 3.710811995666305*^9}, {3.710812089267189*^9, 
   3.71081212394214*^9}, {3.710812245467698*^9, 3.710812277743506*^9}, {
   3.71081239106879*^9, 3.710812423569036*^9}, {3.71081246769449*^9, 
   3.710812519645073*^9}, {3.7108126934213552`*^9, 3.7108127009473124`*^9}, {
   3.710813863879488*^9, 3.710813867893848*^9}, {3.710813965004546*^9, 
   3.710814026455041*^9}, {3.710814063855279*^9, 3.710814097355245*^9}, {
   3.71081415155678*^9, 3.710814160906396*^9}, {3.710814320910265*^9, 
   3.710814350781163*^9}, {3.710814511508253*^9, 3.710814534061426*^9}, {
   3.710815423964734*^9, 3.710815435756584*^9}, 3.710815470816028*^9, {
   3.710815654592167*^9, 3.7108156740413513`*^9}, {3.710816037993417*^9, 
   3.7108160416426086`*^9}, {3.710816230069763*^9, 3.710816249301928*^9}, {
   3.7108225776207438`*^9, 3.710822640121011*^9}, {3.7108227961478233`*^9, 
   3.7108228218471613`*^9}, {3.710822973873128*^9, 3.7108229900484858`*^9}, {
   3.7108231509005547`*^9, 3.710823180275115*^9}, {3.7108232462502937`*^9, 
   3.7108232561012697`*^9}, {3.710823289426762*^9, 3.71082328955107*^9}, {
   3.710823494626904*^9, 3.7108234948278513`*^9}, {3.7108370209868803`*^9, 
   3.710837045037222*^9}, {3.710837378112514*^9, 3.710837391318425*^9}, {
   3.710850524688867*^9, 3.710850530739335*^9}, {3.7108506000881033`*^9, 
   3.7108506397132053`*^9}, {3.7108514292921953`*^9, 3.710851438843075*^9}, {
   3.710851566317347*^9, 3.710851572542454*^9}, 3.710851732543724*^9, {
   3.710880805204013*^9, 3.710880809631941*^9}, {3.710880887103272*^9, 
   3.710880887245531*^9}, {3.710959816237545*^9, 3.7109598724600763`*^9}, 
   3.710974638782646*^9, 3.7109784053366632`*^9, {3.71098195010562*^9, 
   3.710981950306149*^9}, 3.710985327423554*^9, {3.7109963995272217`*^9, 
   3.7109964416681223`*^9}, {3.710999377197962*^9, 3.710999378046878*^9}, {
   3.71099941737173*^9, 3.710999433197249*^9}, {3.711022829761571*^9, 
   3.711022829930461*^9}, {3.7110544919393597`*^9, 3.711054524788969*^9}, {
   3.711069748165471*^9, 3.7110697503133087`*^9}, 
   3.7116775703261213`*^9},ExpressionUUID->"8ad7de42-dfa9-4f83-9024-\
0e63aa51805a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sol", " ", "=", " ", 
       RowBox[{"NDSolve", "[", " ", 
        RowBox[{
         RowBox[{"params", " ", "/.", " ", 
          RowBox[{"pulseFreq", " ", "\[Rule]", " ", "f"}]}], ",", " ", 
         "funcs", ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "tStart", ",", " ", "tEnd"}], "}"}], ",", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"PrecisionGoal", "\[Rule]", "7"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "7"}], ",", " ", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{",", " ", "\[IndentingNewLine]", 
        RowBox[{"PrecisionGoal", "\[Rule]", "7"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "7"}], ",", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", "\"\<StiffnessSwitching\>\"", "}"}]}], ",", 
        RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Take", " ", "electron", " ", "triplet", " ", "sybsystem", " ", "of", 
        " ", "state"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{"pFunc", " ", "=", " ", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", "spin0vec", "]"}], " ", ".", " ", 
        RowBox[{"Map", "[", " ", 
         RowBox[{"Tr", ",", " ", 
          RowBox[{"Partition", "[", " ", 
           RowBox[{"density", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"systemSize", "/", "3"}], ",", " ", 
              RowBox[{"systemSize", "/", "3"}]}], "}"}]}], "]"}], ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}], " ", ".", " ", "spin0vec"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"tEnd", " ", "-", " ", "tStart"}]], 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pFunc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", "sol"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "tStart", ",", " ", "tEnd"}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"data", ",", " ", 
        RowBox[{"{", 
         RowBox[{"f", ",", " ", 
          RowBox[{"p", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"NotebookDelete", "[", "prw", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"prw", " ", "=", " ", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{
        "\"\<Calculation \>\"", ",", " ", "count", ",", " ", 
         "\"\< out of \>\"", ",", " ", "calculations"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"count", " ", "=", " ", 
       RowBox[{"count", " ", "+", " ", "1"}]}], ";"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "f", ",", " ", "pulseFreqStart", ",", " ", "pulseFreqEnd", ",", " ", 
       "pulseFreqStep"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toc", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ttot", " ", "=", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"toc", "-", "tic"}], ")"}], "/", "60"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqAxis", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"f", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "f", ",", " ", "pulseFreqStart", ",", " ", "pulseFreqEnd", ",", " ", 
       "pulseFreqStep"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", " ", "=", " ", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"data", ",", " ", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"comments", ",", " ", "12"}], "]"}]}], ",", " ", 
    RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
     RowBox[{"{", " ", 
      RowBox[{"\"\<Pulse frequency [Hz]\>\"", ",", " ", "\"\<Prob(T_0)\>\""}],
       "}"}]}], ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.7", ",", " ", "1"}], "}"}]}], ",", " ", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], " ", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total time taken (min) = \>\"", ",", "ttot", ",", "2"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.711675996909198*^9, 
  3.7116760125360727`*^9}},ExpressionUUID->"b2caa162-a415-4603-b019-\
fa13b244c988"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","slwcon",
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"",2,422,31,27567891995281784719,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711678098143379*^9, 
  3.711680462252469*^9},ExpressionUUID->"c92c0303-bfbf-4d00-9986-\
8d77484f6ce5"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"t\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"1.6793766671893524`*^-7\\\", \
\\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"1.7720040658026014`*^-6\\\", \\\"+\\\", \
RowBox[{\\\"3.035002330053969`*^-25\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\
\\) and \\!\\(\\*RowBox[{\\\"5.916986327757451`*^-11\\\"}]\\) for the \
integral and error estimates.\"",2,422,32,27567891995281784719,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711678098143379*^9, 
  3.711680462456601*^9},ExpressionUUID->"97b571fd-ad17-476b-b3da-\
5f3efb434ad8"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","slwcon",
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"",2,422,33,27567891995281784719,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711678098143379*^9, 
  3.7116805352560053`*^9},ExpressionUUID->"95a28663-b2af-447b-9168-\
9a7f7e888054"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"t\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"1.4452814167189352`*^-6\\\", \
\\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"1.7373765428902703`*^-6\\\", \\\"+\\\", \
RowBox[{\\\"1.642201840641002`*^-24\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\
\\) and \\!\\(\\*RowBox[{\\\"5.666221969082758`*^-11\\\"}]\\) for the \
integral and error estimates.\"",2,422,34,27567891995281784719,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711678098143379*^9, 
  3.711680536441946*^9},ExpressionUUID->"7417e36d-73dd-45e2-825c-\
272a34176dff"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","slwcon",
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"",2,422,35,27567891995281784719,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711678098143379*^9, 
  3.711680582493881*^9},ExpressionUUID->"7fc0f004-cd6e-4870-9c48-\
613bfe958e05"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"slwcon\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,422,36,27567891995281784719,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711678098143379*^9, 
  3.7116805827496843`*^9},ExpressionUUID->"823b9fe6-1dd4-46d4-b24f-\
d7a5675a8fac"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"t\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"7.304376667189353`*^-7\\\", \
\\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"1.702948431743011`*^-6\\\", \\\"-\\\", \
RowBox[{\\\"3.547387961461152`*^-24\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\
\\) and \\!\\(\\*RowBox[{\\\"6.070114581387857`*^-11\\\"}]\\) for the \
integral and error estimates.\"",2,422,37,27567891995281784719,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711678098143379*^9, 
  3.711680582982059*^9},ExpressionUUID->"ae5db93c-f594-450e-962a-\
112d663da0af"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"ncvb\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,422,38,27567891995281784719,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711678098143379*^9, 
  3.7116805831949883`*^9},ExpressionUUID->"995fb6eb-39c6-4552-8daa-\
9960d37c9a41"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{2.867*^9, 0.8860020329013006}, {2.8679333333333335`*^9, 
      0.8686882714451352}, {2.8688666666666665`*^9, 0.8514742158715055}, {
      2.8698*^9, 0.8337619512496335}, {2.8707333333333335`*^9, 
      0.8133338292995751}, {2.8716666666666665`*^9, 0.7924645320829616}, {
      2.8726*^9, 0.7717052425552576}, {2.8735333333333335`*^9, 
      0.7616378416418841}, {2.8744666666666665`*^9, 0.7517965103244083}, {
      2.8754*^9, 0.7511797047715335}, {2.8763333333333335`*^9, 
      0.7602964712107796}, {2.8772666666666665`*^9, 0.7691960461349406}, {
      2.8782*^9, 0.7900131486924011}, {2.8791333333333335`*^9, 
      0.8106702163757067}, {2.8800666666666665`*^9, 0.8307218739723979}, {
      2.881*^9, 0.8487755702782088}}]}, {}}, {}, {}, {{}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Pulse frequency [Hz]\"", TraditionalForm], 
    FormBox["\"Prob(T_0)\"", TraditionalForm]},
  AxesOrigin->{2.86678125*^9, 0.7014999999999999},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Full,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox[
    "\"Pulse that acts on both nuclear spin and electron spin. B0=0T. \
Frequency Resolution=933333.Hz. Pulse amplitude=7000000Hz\"", 12, 
     StripOnInput -> False], TraditionalForm],
  PlotRange->{{2.867*^9, 2.881*^9}, {0.7, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.711673138026132*^9, 3.711674727952179*^9, 
  3.7116754137738323`*^9, 3.711676341792265*^9, 3.711677445556973*^9, 
  3.711678827715198*^9, 
  3.711681222937056*^9},ExpressionUUID->"63369222-258c-4397-9454-\
de10afa07e33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["data"], "Input",
 CellChangeTimes->{{3.711681496253272*^9, 
  3.711681496540324*^9}},ExpressionUUID->"6a76f2c2-3902-41c8-bd3a-\
267b73ce206f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2.867`*^9", ",", "0.8860020329013006`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.8679333333333335`*^9", ",", "0.8686882714451352`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.8688666666666665`*^9", ",", "0.8514742158715055`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.8698`*^9", ",", "0.8337619512496335`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.8707333333333335`*^9", ",", "0.8133338292995751`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.8716666666666665`*^9", ",", "0.7924645320829616`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.8726`*^9", ",", "0.7717052425552576`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.8735333333333335`*^9", ",", "0.7616378416418841`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.8744666666666665`*^9", ",", "0.7517965103244083`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.8754`*^9", ",", "0.7511797047715335`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.8763333333333335`*^9", ",", "0.7602964712107796`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.8772666666666665`*^9", ",", "0.7691960461349406`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.8782`*^9", ",", "0.7900131486924011`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.8791333333333335`*^9", ",", "0.8106702163757067`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.8800666666666665`*^9", ",", "0.8307218739723979`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.881`*^9", ",", "0.8487755702782088`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.711681497242317*^9},ExpressionUUID->"d214295d-3832-4d73-aa03-\
d367aedf25d5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"fileName", "<>", " ", "\"\<_data.csv\>\""}], ",", " ", "data"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"fileName", "<>", " ", "\"\<_plot.pdf\>\""}], ",", " ", "plot"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Save", "[", " ", 
   RowBox[{
    RowBox[{"fileName", " ", "<>", " ", "\"\<_params.dat\>\""}], ",", " ", 
    RowBox[{"{", "  ", 
     RowBox[{
     "comments", ",", " ", "ttot", ",", " ", "pulseAmplitude", ",", 
      "pulsePhase", ",", "pulseFreqStart", ",", "pulseFreqEnd", ",", 
      "calculations", ",", "pulseFreqStep", ",", "\[Gamma]N", ",", 
      "\[Gamma]e", ",", "B0", ",", "\[Omega]s", ",", "\[Omega]I", ",", "Ahf", 
      ",", "Dzfs", ",", "Pzfs", ",", " ", "eSx", ",", " ", "eSz", ",", " ", 
      "Iz", ",", " ", "Hhf", ",", " ", "Hnv", ",", " ", "Hcop"}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.710999431121374*^9, 3.711673538697214*^9, 3.711675922525928*^9, {
   3.711675995428422*^9, 3.711675995962738*^9}, 
   3.711676046761698*^9},ExpressionUUID->"b01f7d69-4111-43de-9579-\
72b178dda40c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7108516500609617`*^9, 3.710851722696393*^9}, {
  3.710879308907813*^9, 3.71087931458377*^9}, {3.710879553372398*^9, 
  3.710879577154264*^9}, {3.710879683282827*^9, 
  3.710879766847363*^9}},ExpressionUUID->"26bbc477-e6df-4186-b4f5-\
fbfa02456bfe"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{959, 1027},
WindowMargins->{{Automatic, -260}, {-173, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 819, 20, 102, "Input", "ExpressionUUID" -> \
"1d14f45f-75ef-4245-994f-5c3c47751f62"],
Cell[CellGroupData[{
Cell[1402, 44, 163, 3, 93, "Title", "ExpressionUUID" -> \
"d49ea734-8d64-4325-929d-d380436e71a0"],
Cell[CellGroupData[{
Cell[1590, 51, 163, 3, 66, "Chapter", "ExpressionUUID" -> \
"5e946c75-9857-49e7-8818-3184363a9c1d"],
Cell[1756, 56, 4939, 108, 559, "Input", "ExpressionUUID" -> \
"bd9c4d79-b9a7-4f4d-840d-f4c5f5825600"],
Cell[6698, 166, 3699, 101, 359, "Input", "ExpressionUUID" -> \
"db2dbe06-37cf-4783-a3f7-4df778d19dae"],
Cell[10400, 269, 4263, 115, 510, "Input", "ExpressionUUID" -> \
"2db4cba3-a1df-42cc-8c1f-edcdc856c65d"],
Cell[14666, 386, 4076, 97, 419, "Input", "ExpressionUUID" -> \
"6de995e6-fce7-4776-aa7a-d0e71c36c4d2"],
Cell[CellGroupData[{
Cell[18767, 487, 1845, 46, 190, "Input", "ExpressionUUID" -> \
"13606bea-4877-4b60-974a-58a1ea9a83f5"],
Cell[20615, 535, 11601, 318, 197, "Output", "ExpressionUUID" -> \
"790a28d2-c144-47ca-9228-543a23c2c9e8"]
}, Open  ]],
Cell[32231, 856, 1526, 38, 124, "Input", "ExpressionUUID" -> \
"bf453454-d952-4e64-ba3b-1f333bce6a5f"],
Cell[33760, 896, 3560, 92, 237, "Input", "ExpressionUUID" -> \
"31405b0b-2958-465e-b2c3-9472ed0f9157"],
Cell[37323, 990, 3230, 58, 147, "Input", "ExpressionUUID" -> \
"8ad7de42-dfa9-4f83-9024-0e63aa51805a"],
Cell[CellGroupData[{
Cell[40578, 1052, 4879, 120, 634, "Input", "ExpressionUUID" -> \
"b2caa162-a415-4603-b019-fa13b244c988"],
Cell[45460, 1174, 455, 10, 41, "Message", "ExpressionUUID" -> \
"c92c0303-bfbf-4d00-9986-8d77484f6ce5"],
Cell[45918, 1186, 824, 15, 69, "Message", "ExpressionUUID" -> \
"97b571fd-ad17-476b-b3da-5f3efb434ad8"],
Cell[46745, 1203, 457, 10, 41, "Message", "ExpressionUUID" -> \
"95a28663-b2af-447b-9168-9a7f7e888054"],
Cell[47205, 1215, 824, 15, 70, "Message", "ExpressionUUID" -> \
"7417e36d-73dd-45e2-825c-272a34176dff"],
Cell[48032, 1232, 455, 10, 41, "Message", "ExpressionUUID" -> \
"7fc0f004-cd6e-4870-9c48-613bfe958e05"],
Cell[48490, 1244, 430, 9, 23, "Message", "ExpressionUUID" -> \
"823b9fe6-1dd4-46d4-b24f-d7a5675a8fac"],
Cell[48923, 1255, 822, 15, 70, "Message", "ExpressionUUID" -> \
"ae5db93c-f594-450e-962a-112d663da0af"],
Cell[49748, 1272, 428, 9, 23, "Message", "ExpressionUUID" -> \
"995fb6eb-39c6-4552-8daa-9960d37c9a41"],
Cell[50179, 1283, 2430, 54, 441, "Output", "ExpressionUUID" -> \
"63369222-258c-4397-9454-de10afa07e33"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52646, 1342, 156, 3, 32, "Input", "ExpressionUUID" -> \
"6a76f2c2-3902-41c8-bd3a-267b73ce206f"],
Cell[52805, 1347, 1692, 48, 188, "Output", "ExpressionUUID" -> \
"d214295d-3832-4d73-aa03-d367aedf25d5"]
}, Open  ]],
Cell[54512, 1398, 1227, 28, 148, "Input", "ExpressionUUID" -> \
"b01f7d69-4111-43de-9579-72b178dda40c"],
Cell[55742, 1428, 297, 5, 32, "Input", "ExpressionUUID" -> \
"26bbc477-e6df-4186-b4f5-fbfa02456bfe"]
}, Open  ]]
}, Open  ]]
}
]
*)

