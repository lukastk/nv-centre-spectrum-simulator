(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     78889,       2011]
NotebookOptionsPosition[     74047,       1893]
NotebookOutlinePosition[     74381,       1908]
CellTagsIndexPosition[     74338,       1905]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fileName", " ", "=", " ", 
   RowBox[{"\"\<results/nv_center_simulation\>\"", "  ", "<>", " ", 
    RowBox[{"StringReplace", "[", " ", 
     RowBox[{
      RowBox[{"DateString", "[", "\"\<ISODateTime\>\"", "]"}], ",", " ", 
      RowBox[{"\"\<:\>\"", " ", "\[Rule]", " ", "\"\<.\>\""}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.710804308136487*^9, 3.710804308444024*^9}, {
   3.710851376716381*^9, 3.7108513846410437`*^9}, 
   3.71087924794349*^9},ExpressionUUID->"601682c8-0029-4b05-a483-\
75230eaf7c4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Simulation", " ", "parameters"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pulseAmplitude", " ", "=", " ", 
     RowBox[{"7", "*", 
      SuperscriptBox["10", "6"]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulsePhase", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tStart", " ", "=", " ", "0"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "s", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tEnd", " ", "=", " ", 
     RowBox[{"2", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "s", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pulseFreqStart", " ", "=", " ", 
      RowBox[{"500", "*", 
       SuperscriptBox["10", "6"]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pulseFreqEnd", " ", "=", " ", 
      RowBox[{"530", "*", 
       SuperscriptBox["10", "7"]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"[", "Hz", "]"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"pulseFreqStart", " ", "=", " ", 
      RowBox[{"1.369", "*", 
       SuperscriptBox["10", "9"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pulseFreqEnd", "=", 
      RowBox[{"1.5", "*", 
       SuperscriptBox["10", "9"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pulseFreqStart", " ", "=", " ", 
      RowBox[{"1.43", "*", 
       SuperscriptBox["10", "9"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pulseFreqEnd", "=", 
      RowBox[{"1.4331", "*", 
       SuperscriptBox["10", "9"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"pulseFreqStart", " ", "=", " ", 
      RowBox[{"7.16", "*", 
       SuperscriptBox["10", "9"]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pulseFreqEnd", " ", "=", " ", 
      RowBox[{"7.22", "*", 
       SuperscriptBox["10", "8"]}]}], ";"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"[", "Hz", "]"}], " ", "*)"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulseFreqStart", " ", "=", " ", 
     RowBox[{"2.867", "*", 
      SuperscriptBox["10", "9"]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"pulseFreqEnd", " ", "=", " ", 
     RowBox[{"2.881", "*", 
      SuperscriptBox["10", "9"]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"[", "Hz", "]"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
    RowBox[{"pulseFreqStep", " ", "=", " ", 
     SuperscriptBox["10", "6"]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"[", "Hz", "]"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
    RowBox[{"calculations", " ", "=", " ", 
     RowBox[{
      RowBox[{"Table", "[", " ", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "f", ",", " ", "pulseFreqStart", ",", " ", "pulseFreqEnd", ",", " ", 
          "pulseFreqStep"}], "}"}]}], "]"}], " ", "//", " ", "Length"}]}], 
    " ", ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.710806009149169*^9, {3.7108060566239357`*^9, 3.7108060752750874`*^9}, {
   3.710806143724998*^9, 3.710806318226289*^9}, {3.710812460244783*^9, 
   3.710812462818932*^9}, {3.7108127241709423`*^9, 3.7108127245205584`*^9}, 
   3.71081590826723*^9, {3.7108238758294067`*^9, 3.7108238825293713`*^9}, {
   3.7108239943052273`*^9, 3.710824032705736*^9}, {3.710837065511478*^9, 
   3.7108370792110653`*^9}, {3.710837287112187*^9, 3.710837311411633*^9}, 
   3.710850728639022*^9, {3.7108508709140263`*^9, 3.7108509316150846`*^9}, {
   3.710850997790325*^9, 3.7108511056412487`*^9}, 3.710851256449295*^9, {
   3.710851599293901*^9, 3.710851602542963*^9}, {3.710851841043202*^9, 
   3.710851877968454*^9}, {3.7108814322324543`*^9, 3.7108814330430517`*^9}, {
   3.710881870164485*^9, 3.710881884134583*^9}, {3.710975563446197*^9, 
   3.71097561237866*^9}, {3.710978225559168*^9, 3.710978235484942*^9}, {
   3.710978291234782*^9, 3.710978383535391*^9}, {3.710981799778274*^9, 
   3.71098180230372*^9}, {3.710982583036131*^9, 3.710982586110607*^9}, {
   3.7109994816473007`*^9, 3.7109994941218157`*^9}, {3.711002946488125*^9, 
   3.711002962938561*^9}, {3.7110059921005487`*^9, 3.711006005750245*^9}, {
   3.71101057050115*^9, 3.7110105753517733`*^9}, {3.711010622325823*^9, 
   3.711010670225429*^9}, {3.711055674994376*^9, 3.711055695067766*^9}, 
   3.711055741795199*^9, 3.711072196196651*^9, 3.7110791051450777`*^9, 
   3.711424174947625*^9, {3.711425706885902*^9, 3.7114257134279957`*^9}, 
   3.711427939573992*^9},ExpressionUUID->"d6b8bbba-177c-439f-b018-\
febaeff2810a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Constants", " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]N", " ", "=", " ", 
     RowBox[{"19.331", "*", 
      SuperscriptBox["10", "6"]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Gyromagnetic", " ", "ratio", " ", "for", 
     SuperscriptBox[" ", "14"], 
     RowBox[{"N", " ", "[", 
      RowBox[{
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox["T", 
        RowBox[{"-", "1"}]]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]e", " ", "=", " ", 
     RowBox[{"1.7609", "*", 
      SuperscriptBox["10", "11"]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Gyromagnetic", " ", "ratio", " ", "for", " ", "e"}], "-", " ", 
     RowBox[{"[", 
      RowBox[{"rad", " ", 
       SuperscriptBox["s", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox["T", 
        RowBox[{"-", "1"}]]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B0", " ", "=", 
     RowBox[{"0.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"DC", " ", "Applied", " ", 
      RowBox[{"field", " ", "[", "T", "]"}]}], " ", "*)"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]s", "=", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "\[Gamma]e"}], " ", "B0"}], 
      RowBox[{"2", "\[Pi]"}]]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]I", "=", 
     FractionBox[
      RowBox[{"\[Gamma]N", " ", "B0"}], 
      RowBox[{"2", "\[Pi]"}]]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Axyhf", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "2.1"}], "*", 
      SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Azhf", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "2.16"}], "*", 
      SuperscriptBox["10", "6"]}]}], " ", ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Hyperfine", " ", 
     RowBox[{"interaction", " ", "[", "Hz", "]"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dzfs", " ", "=", " ", 
     RowBox[{"2870", "*", 
      SuperscriptBox["10", "6"]}]}], " ", ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Zero", "-", "field", "-", 
     RowBox[{"splitting", " ", "for", " ", "electron", " ", 
      RowBox[{"triplet", " ", "[", "Hz", "]"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pzfs", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "4.95"}], "*", 
      SuperscriptBox["10", "6"]}]}], " ", ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Zero", "-", "field", "-", 
     RowBox[{"splitting", " ", "for", 
      SuperscriptBox[" ", "14"], 
      RowBox[{"N", " ", "[", "Hz", "]"}]}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.710803700158299*^9, 3.710803705157847*^9}, {
   3.710803763033595*^9, 3.710803782008196*^9}, {3.710806321001631*^9, 
   3.7108063795519257`*^9}, 3.7108154002393503`*^9, {3.710978264509679*^9, 
   3.71097826473475*^9}, {3.710981793378274*^9, 3.710981793854289*^9}, {
   3.7109966571936827`*^9, 3.710996658118456*^9}, {3.711078310717197*^9, 
   3.71107831106719*^9}, 3.7110806984748087`*^9, {3.711081131926388*^9, 
   3.711081160876442*^9}, {3.711082050579837*^9, 3.7110820521301126`*^9}, {
   3.7111659639542933`*^9, 3.7111659640291243`*^9}, {3.711166089479608*^9, 
   3.711166089679452*^9}, {3.711166151029944*^9, 3.7111661516798983`*^9}, {
   3.7111662178554*^9, 3.711166231805862*^9}, {3.711166272715975*^9, 
   3.7111662740304737`*^9}, {3.7111663716812153`*^9, 
   3.7111663915311813`*^9}, {3.7111664485815163`*^9, 3.711166449481646*^9}, {
   3.7111665940826387`*^9, 3.711166595506995*^9}, {3.711166666507867*^9, 
   3.711166666807613*^9}, {3.711167304035954*^9, 3.7111673198109083`*^9}, 
   3.711327956963976*^9, {3.711331151006875*^9, 
   3.711331152706791*^9}},ExpressionUUID->"e1329ae7-19b1-408f-95d9-\
e9481b61a566"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Triplet", " ", "spin", " ", "operators"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Sx", " ", "=", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Sqrt", "[", "2", "]"}]], 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"{", "  ", 
         RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}], " ", ",", " ", 
        RowBox[{"{", " ", 
         RowBox[{"1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "1", ",", " ", "0"}], " ", "}"}]}], " ", 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sy", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          FractionBox["\[ImaginaryI]", 
           SqrtBox["2"]]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]], ",", "0", ",", 
         RowBox[{"-", 
          FractionBox["\[ImaginaryI]", 
           SqrtBox["2"]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]], ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sz", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "0", ",", " ", "0"}], " ", "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eye", " ", "=", " ", 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Electron", " ", "triplet", " ", "operators"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eSx", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"Sx", ",", " ", "eye"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"eSy", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"Sy", ",", " ", "eye"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"eSz", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"Sz", ",", " ", "eye"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Nuclear", " ", "operators"}], " ", "*)"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ix", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"eye", ",", " ", "Sx"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Iy", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"eye", ",", " ", "Sy"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Iz", " ", "=", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"eye", ",", " ", "Sz"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710803813041401*^9, 3.7108038444336233`*^9}, {
   3.71080387890902*^9, 3.710803910408915*^9}, {3.710804180585863*^9, 
   3.710804260337324*^9}, {3.71080641837753*^9, 3.710806476202467*^9}, {
   3.71080650842901*^9, 3.710806547102943*^9}, {3.7108240490812597`*^9, 
   3.710824058280965*^9}, {3.711081265302009*^9, 3.7110812867021017`*^9}, {
   3.7110814751273727`*^9, 3.711081475777274*^9}, {3.711331623684894*^9, 
   3.711331626034602*^9}, 
   3.71133170906957*^9},ExpressionUUID->"05f76c44-2fcb-49d1-a396-\
a70c2752e3ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Setup", " ", "Hamiltonian"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Hhf", "=", " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"Axyhf", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"eSx", ".", "Ix"}], " ", "+", " ", 
          RowBox[{"eSy", ".", "Iy"}]}], " ", ")"}]}], " ", "+", " ", 
       RowBox[{"Azhf", " ", 
        RowBox[{"eSz", " ", ".", " ", "Iz"}]}]}], ")"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hnv", " ", "=", "  ", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Dzfs", " ", 
         RowBox[{"eSz", ".", "eSz"}]}], "  ", "+", " ", 
        RowBox[{"\[Omega]s", " ", "eSz"}], " ", "+", " ", 
        RowBox[{"Pzfs", "  ", 
         RowBox[{"Iz", ".", "Iz"}]}], " ", "-", " ", 
        RowBox[{"\[Omega]I", " ", "Iz"}]}], ")"}], " ", "+", " ", "Hhf"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hcop", " ", "=", " ", 
     RowBox[{"pulseAmplitude", "  ", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"Sx", ",", " ", "Sx"}], "]"}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Hc", "[", "t_", "]"}], ":=", " ", 
     RowBox[{"Hcop", " ", 
      RowBox[{"Sin", "[", " ", 
       RowBox[{
        RowBox[{"2", "\[Pi]", " ", "pulseFreq", " ", "t"}], " ", "+", " ", 
        "pulsePhase"}], " ", "]"}]}]}], "  ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H", "[", "t_", "]"}], " ", ":=", " ", 
    RowBox[{"Hnv", "+", " ", 
     RowBox[{"Hc", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"systemSize", " ", "=", " ", 
     RowBox[{"Length", "[", 
      RowBox[{"H", "[", "0", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"comments", " ", "=", " ", 
     RowBox[{"StringRiffle", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "\"\<Pulse that acts on both nuclear spin and electron spin\>\"", ",",
          "\[IndentingNewLine]", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<B0=``T\>\"", ",", "B0"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<Frequency Resolution=``Hz\>\"", ",", " ", "pulseFreqStep"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<Pulse amplitude=``Hz\>\"", ",", " ", "pulseAmplitude"}], 
          "]"}]}], "\[IndentingNewLine]", "}"}], ",", " ", "\"\<. \>\""}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Hnv", " ", "//", " ", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.710804314474235*^9, 3.710804325611812*^9}, {
   3.710804528737977*^9, 3.710804528988124*^9}, 3.7108059713753767`*^9, 
   3.710806393726984*^9, {3.710806592828232*^9, 3.710806595103409*^9}, {
   3.71080682862997*^9, 3.710806846505134*^9}, {3.710881199929245*^9, 
   3.7108812319129477`*^9}, {3.710881267076969*^9, 3.710881354978258*^9}, {
   3.71088158582417*^9, 3.7108815876256227`*^9}, {3.710881648021428*^9, 
   3.710881751765052*^9}, {3.7109819613552217`*^9, 3.710982088506267*^9}, {
   3.710982190332514*^9, 3.710982231532476*^9}, {3.710982306758369*^9, 
   3.71098246166004*^9}, {3.710982498660706*^9, 3.710982534510517*^9}, {
   3.7110028887630444`*^9, 3.71100289071318*^9}, {3.711081294627138*^9, 
   3.7110813123522577`*^9}, {3.711166995584572*^9, 3.711166995609482*^9}, {
   3.711167067409683*^9, 3.7111670732594423`*^9}, {3.711167162710473*^9, 
   3.711167165235175*^9}, {3.711167629437518*^9, 3.711167642187262*^9}, {
   3.7113315617346697`*^9, 3.7113315770340767`*^9}, 
   3.711428282782937*^9},ExpressionUUID->"37922a1c-c325-4d4e-a563-\
6ea74af87a88"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2.86289`*^9", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "2.87`*^9", "0.`", 
      RowBox[{"-", "2.1`*^6"}], "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "2.86721`*^9", "0.`", 
      RowBox[{"-", "2.1`*^6"}], "0.`", "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"-", "2.1`*^6"}], "0.`", 
      RowBox[{"-", "4.95`*^6"}], "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "2.1`*^6"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "2.1`*^6"}], "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "4.95`*^6"}], "0.`", 
      RowBox[{"-", "2.1`*^6"}], "0.`"},
     {"0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "2.1`*^6"}], "0.`", "2.86721`*^9", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "2.1`*^6"}], "0.`", "2.87`*^9", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "2.86289`*^9"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.711427946008561*^9, 3.711428283349649*^9, 
  3.711428439115054*^9},ExpressionUUID->"d8c9e8eb-2dc0-4b41-ac0c-\
4e67b5745d5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sy", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.711427395302251*^9, 
  3.711427404122863*^9}},ExpressionUUID->"e938f197-365c-44a9-9427-\
74231aa063e4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], "0"},
     {
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}]},
     {"0", 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.711331562052383*^9, 3.7113315771887207`*^9}, 
   3.711331716629509*^9, 3.7113324230594273`*^9, 3.711423887073121*^9, 
   3.7114257604488077`*^9, {3.711427396947098*^9, 3.7114274044067287`*^9}, 
   3.7114279461047373`*^9, 
   3.7114284391866283`*^9},ExpressionUUID->"2e1c3051-ae60-46b5-be01-\
1ee68cdff22a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "Hnv", "]"}]], "Input",
 CellChangeTimes->{{3.711332425803155*^9, 
  3.711332428888604*^9}},ExpressionUUID->"9ed35f94-c0fb-4416-a2ba-\
87aa12648688"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.870001533938902`*^9", ",", "2.870001533938902`*^9", ",", 
   "2.867213076157846`*^9", ",", "2.86721`*^9", ",", "2.86289`*^9", ",", 
   "2.86289`*^9", ",", 
   RowBox[{"-", "4.951533938902253`*^6"}], ",", 
   RowBox[{"-", "4.951533938902253`*^6"}], ",", 
   RowBox[{"-", "3076.1578459739685`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.711332429350748*^9, 3.711423887146266*^9, 
  3.71142576045383*^9, 3.711427946410225*^9, 
  3.711428439281649*^9},ExpressionUUID->"c3ee4df5-cef8-4d7e-a5b8-\
37973b799786"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hcop", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.711327967188637*^9, 3.71132797716406*^9}, {
   3.71133099190595*^9, 3.711330996505402*^9}, {3.7113310748570538`*^9, 
   3.711331076209921*^9}, 
   3.711424370021999*^9},ExpressionUUID->"f74fb202-a85c-486e-b2ea-\
93157dfc1da6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "3500000", "0", "0", "0", "0"},
     {"0", "0", "0", "3500000", "0", "3500000", "0", "0", "0"},
     {"0", "0", "0", "0", "3500000", "0", "0", "0", "0"},
     {"0", "3500000", "0", "0", "0", "0", "0", "3500000", "0"},
     {"3500000", "0", "3500000", "0", "0", "0", "3500000", "0", "3500000"},
     {"0", "3500000", "0", "0", "0", "0", "0", "3500000", "0"},
     {"0", "0", "0", "0", "3500000", "0", "0", "0", "0"},
     {"0", "0", "0", "3500000", "0", "3500000", "0", "0", "0"},
     {"0", "0", "0", "0", "3500000", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.711327951747014*^9, 3.711327977556795*^9}, 
   3.711330996742852*^9, 3.7113310764265203`*^9, 3.711331158182867*^9, 
   3.711331716635564*^9, 3.711423887218648*^9, 3.711424370338368*^9, 
   3.711425760472672*^9, 3.711427946489874*^9, 
   3.71142843936456*^9},ExpressionUUID->"857b5152-ebd5-44e8-b0ad-\
c6f33cabdb1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"Dzfs", " ", 
      RowBox[{"eSz", ".", "eSz"}]}], "  ", "+", "  ", 
     RowBox[{"Pzfs", "  ", 
      RowBox[{"Iz", ".", "Iz"}]}]}], " ", ")"}], " ", "//", " ", 
   "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.7113317641211987`*^9, 3.711331768509799*^9}, {
  3.711331856311874*^9, 3.7113318894603786`*^9}, {3.711331980861569*^9, 
  3.7113320238110037`*^9}},ExpressionUUID->"0a91147d-77f7-405a-a68a-\
a33c34bb5ee7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2.86505`*^9", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "2.87`*^9", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "2.86505`*^9", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", 
      RowBox[{"-", "4.95`*^6"}], "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "4.95`*^6"}], "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "2.86505`*^9", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "2.87`*^9", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "2.86505`*^9"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.711331986647319*^9, 3.7113320241272707`*^9}, 
   3.7114238872932796`*^9, 3.711425760491665*^9, 3.7114279465691423`*^9, 
   3.7114284394353848`*^9},ExpressionUUID->"d95cc162-f615-4461-8815-\
67851b1a40cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Setup", " ", "Density", " ", "matrix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"density", " ", "=", " ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"i", ",", " ", "j"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", "systemSize"}], "}"}]}], 
      "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"density", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"density", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", " ", 
      
      RowBox[{"{", 
       RowBox[{"j", ",", " ", 
        RowBox[{"i", "+", "1"}], ",", " ", "systemSize"}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"density", " ", "//", " ", "MatrixForm"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.710804535788083*^9, 3.7108045583173437`*^9}, {
  3.710804617464055*^9, 3.710804622515006*^9}, {3.7108053621696978`*^9, 
  3.710805362969448*^9}, {3.710805470720196*^9, 3.7108054709451427`*^9}, {
  3.710805899223364*^9, 3.71080594477358*^9}, {3.710806806405459*^9, 
  3.710806864456637*^9}, {3.710807003456621*^9, 
  3.710807003856599*^9}},ExpressionUUID->"7ac6f8f5-ef3d-4605-9dba-\
77f21b0ddc63"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "4"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"1", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"2", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "3"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "4"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"3", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "4"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "4"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "4"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"4", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "5"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "5"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "5"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "5"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "5"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"5", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"5", ",", "6"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"6", ",", "6"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"6", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"6", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"6", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"5", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"6", ",", "7"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"7", ",", "7"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"7", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"7", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"5", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"6", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"7", ",", "8"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"8", ",", "8"}], "]"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"8", ",", "9"}], "]"}], "[", "t", "]"}]},
     {
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"1", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"2", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"3", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"4", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"5", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"6", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"7", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"8", ",", "9"}], "]"}], "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"9", ",", "9"}], "]"}], "[", "t", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.710805904210074*^9, 3.7108059183380957`*^9}, 
   3.710806652281618*^9, {3.710806849300684*^9, 3.7108068648125277`*^9}, 
   3.710807547108816*^9, 3.710811807846637*^9, 3.710812729095531*^9, 
   3.710814132476225*^9, 3.710814170012809*^9, 3.710815438355691*^9, 
   3.710815911466321*^9, 3.71083733941352*^9, 3.7108373968374977`*^9, 
   3.710851414119883*^9, 3.710881369304091*^9, {3.7108818097963457`*^9, 
   3.7108818214469833`*^9}, 3.710881888570239*^9, 3.7109437694159613`*^9, {
   3.710978397815897*^9, 3.710978410612612*^9}, 3.710982598724537*^9, 
   3.71099666456656*^9, 3.7109995126676207`*^9, 3.7110030063936367`*^9, 
   3.711006009230526*^9, 3.7110106994374313`*^9, 3.711054556555934*^9, 
   3.711055699585916*^9, 3.711055744033495*^9, 3.711069736567005*^9, 
   3.7110702886961937`*^9, 3.711070598042447*^9, 3.711070655456015*^9, 
   3.711072283555867*^9, 3.7110784842224293`*^9, 3.711079130133847*^9, 
   3.7111655816190968`*^9, 3.711165970238167*^9, 3.711166098171248*^9, {
   3.711166263828878*^9, 3.7111662791645403`*^9}, {3.7111663810293083`*^9, 
   3.711166398880041*^9}, 3.711166540793871*^9, 3.711166601503543*^9, 
   3.711166672265151*^9, 3.7111670882977533`*^9, {3.7111673111037483`*^9, 
   3.7111673284452753`*^9}, 3.711167654658003*^9, 3.71142388736974*^9, 
   3.711425760518242*^9, 3.711427946660593*^9, 
   3.7114284395094337`*^9},ExpressionUUID->"aaf79f3f-50c1-45f1-b7e0-\
cdf6768a1486"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "initial", " ", "state", " ", "of", " ", "system"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"es", " ", "=", " ", 
     RowBox[{"Eigensystem", "[", "Hnv", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"groundState", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"es", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"es", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"es", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "}"}], " ", "//", " ",
       "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"density0", " ", "=", " ", 
     RowBox[{"groundState", " ", ".", " ", 
      RowBox[{"ConjugateTranspose", "[", "groundState", "]"}]}]}], " ", 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710806998725523*^9, 3.710807044031006*^9}, {
   3.710807078232047*^9, 3.710807373960236*^9}, 3.7108075535347013`*^9, {
   3.710812006866643*^9, 3.7108120761414757`*^9}, {3.7108818041300507`*^9, 
   3.710881805465757*^9}, {3.711169001892218*^9, 
   3.711169030041975*^9}},ExpressionUUID->"38f60a8c-8f33-4daf-a785-\
138d0fc5ea11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anngmoms", " ", "=", " ", 
   RowBox[{"Map", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", " ", ".", " ", "eSz", " ", ".", " ", "#"}], ",", " ", 
        RowBox[{"#", " ", ".", " ", "Iz", " ", ".", " ", "#"}]}], "}"}], " ", 
      "&"}], ",", " ", 
     RowBox[{"es", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71116904174188*^9, 3.711169088467152*^9}, {
  3.711169183243421*^9, 
  3.7111691887421217`*^9}},ExpressionUUID->"08bd9d09-be0d-4fe1-804b-\
9981ec2b57f4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Append", "[", 
    RowBox[{"es", ",", " ", "anngmoms"}], "]"}], " ", "//", " ", 
   "Transpose"}], " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Energy", " ", "-", " ", "Eigenvalue", " ", "-", " ", 
    RowBox[{"Angular", " ", "momentum"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.711169101042399*^9, 3.7111691161962223`*^9}, {
  3.711169191818039*^9, 3.711169212092289*^9}, {3.711169667620696*^9, 
  3.71116967906925*^9}},ExpressionUUID->"98d51e81-3d6f-44b6-8a49-\
da2fe2cffc58"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2.8700015339389024`*^9", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
        RowBox[{"-", "0.0007304469014447892`"}], ",", "0.`", ",", 
        "0.9999997332236265`", ",", "0.`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.9999994664473241`"}], ",", 
        RowBox[{"-", "5.335526758302936`*^-7"}]}], "}"}]},
     {"2.8700015339389024`*^9", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "0.9999997332236265`", ",", "0.`", ",", 
        RowBox[{"-", "0.0007304469014447897`"}], ",", "0.`", ",", "0.`", ",", 
        "0.`", ",", "0.`", ",", "0.`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"0.9999994664473241`", ",", "5.335526758302943`*^-7"}], 
       "}"}]},
     {"2.867213076157846`*^9", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "0.`", ",", "0.7071064018686761`", ",", "0.`", ",", 
        RowBox[{"-", "0.0010357956695105914`"}], ",", "0.`", ",", 
        "0.7071064018686759`", ",", "0.`", ",", "0.`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"3.3306690738754696`*^-16", ",", 
        RowBox[{"-", "3.3306690738754696`*^-16"}]}], "}"}]},
     {"2.86721`*^9", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "0.`", ",", "0.7071067811865476`", ",", "0.`", ",", 
        RowBox[{"-", "9.18728387252679`*^-19"}], ",", "0.`", ",", 
        RowBox[{"-", "0.7071067811865476`"}], ",", "0.`", ",", "0.`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "0.`"}], "}"}]},
     {"2.86289`*^9", 
      RowBox[{"{", 
       RowBox[{
       "1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",",
         "0.`", ",", "0.`", ",", "0.`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"1.`", ",", "1.`"}], "}"}]},
     {"2.86289`*^9", 
      RowBox[{"{", 
       RowBox[{
       "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",",
         "0.`", ",", "0.`", ",", "1.`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.`"}], ",", 
        RowBox[{"-", "1.`"}]}], "}"}]},
     {
      RowBox[{"-", "4.951533938901424`*^6"}], 
      RowBox[{"{", 
       RowBox[{
       "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
        "0.9999997332236265`", ",", "0.`", ",", "0.0007304469014447894`", ",",
         "0.`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5.335526758302939`*^-7"}], ",", 
        RowBox[{"-", "0.9999994664473241`"}]}], "}"}]},
     {
      RowBox[{"-", "4.951533938899517`*^6"}], 
      RowBox[{"{", 
       RowBox[{
       "0.`", ",", "0.0007304469014447896`", ",", "0.`", ",", 
        "0.9999997332236265`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`",
         ",", "0.`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"5.335526758302942`*^-7", ",", "0.9999994664473241`"}], 
       "}"}]},
     {
      RowBox[{"-", "3076.15784406662`"}], 
      RowBox[{"{", 
       RowBox[{
       "0.`", ",", "0.`", ",", "0.0007324181418346001`", ",", "0.`", ",", 
        "0.9999994635635217`", ",", "0.`", ",", "0.0007324181418345988`", ",",
         "0.`", ",", "0.`"}], "}"}], 
      RowBox[{"{", 
       RowBox[{"1.9058241313221758`*^-21", ",", 
        RowBox[{"-", "1.9058241313221758`*^-21"}]}], "}"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.711169101228958*^9, 3.711169116383691*^9}, 
   3.711169167758835*^9, 3.7111692124649553`*^9, 3.7111696811741123`*^9, 
   3.711423887507287*^9, 3.7114257605528812`*^9, 3.711427947046823*^9, 
   3.711428439642386*^9},ExpressionUUID->"71a67c95-da0c-4c26-89a4-\
e53615b780ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"state00", " ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], "]"}], " ", "//",
      " ", "Flatten"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state00", ".", " ", "Hnv", " ", ".", " ", "state00"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state01", " ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], "]"}], " ", "//",
      " ", "Flatten"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state01", ".", " ", "Hnv", " ", ".", " ", "state01"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state10", " ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", " ", 
        RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], "]"}], " ", "//",
      " ", "Flatten"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state10", ".", " ", "Hnv", " ", ".", " ", "state10"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state0m1", " ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", " ", 
        RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], " ", "//",
      " ", "Flatten"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"state0m1", ".", " ", "Hnv", " ", ".", " ", "state0m1"}]}], "Input",
 CellChangeTimes->{{3.711166543056162*^9, 3.711166699183777*^9}, {
  3.711166795308457*^9, 3.7111668200832853`*^9}, {3.7111669407838182`*^9, 
  3.711166965733832*^9}},ExpressionUUID->"b5b816e3-5546-4264-bcae-\
aec2deba4692"],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.711166587579212*^9, 3.711166601629794*^9}, {
   3.711166644504241*^9, 3.711166699505065*^9}, {3.711166961551406*^9, 
   3.711166967053039*^9}, 3.711167088447844*^9, 3.711167328595883*^9, 
   3.711167658036241*^9, 3.7114238875813017`*^9, 3.711425760571247*^9, 
   3.711427947133464*^9, 
   3.711428439711104*^9},ExpressionUUID->"8f6c1270-7659-472c-bb31-\
9986382fe0db"],

Cell[BoxData[
 RowBox[{"-", "4.95`*^6"}]], "Output",
 CellChangeTimes->{{3.711166587579212*^9, 3.711166601629794*^9}, {
   3.711166644504241*^9, 3.711166699505065*^9}, {3.711166961551406*^9, 
   3.711166967053039*^9}, 3.711167088447844*^9, 3.711167328595883*^9, 
   3.711167658036241*^9, 3.7114238875813017`*^9, 3.711425760571247*^9, 
   3.711427947133464*^9, 
   3.711428439712079*^9},ExpressionUUID->"442d8346-bbaf-478d-97b2-\
0b80ab3f1673"],

Cell[BoxData["2.87`*^9"], "Output",
 CellChangeTimes->{{3.711166587579212*^9, 3.711166601629794*^9}, {
   3.711166644504241*^9, 3.711166699505065*^9}, {3.711166961551406*^9, 
   3.711166967053039*^9}, 3.711167088447844*^9, 3.711167328595883*^9, 
   3.711167658036241*^9, 3.7114238875813017`*^9, 3.711425760571247*^9, 
   3.711427947133464*^9, 
   3.7114284397129307`*^9},ExpressionUUID->"edb03dfc-24be-4236-b7da-\
41d81c275b76"],

Cell[BoxData[
 RowBox[{"-", "4.95`*^6"}]], "Output",
 CellChangeTimes->{{3.711166587579212*^9, 3.711166601629794*^9}, {
   3.711166644504241*^9, 3.711166699505065*^9}, {3.711166961551406*^9, 
   3.711166967053039*^9}, 3.711167088447844*^9, 3.711167328595883*^9, 
   3.711167658036241*^9, 3.7114238875813017`*^9, 3.711425760571247*^9, 
   3.711427947133464*^9, 
   3.7114284397137814`*^9},ExpressionUUID->"2e0a22c5-f999-4ca4-ae3c-\
24e7dc04633f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "master", " ", "equation"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eqnTotal", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ImaginaryI]", "  ", 
        RowBox[{"D", "[", " ", 
         RowBox[{"density", ",", " ", "t"}], "]"}]}], " ", "-", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", "t", "]"}], ".", "density"}], " ", "-", " ", 
         RowBox[{"density", ".", 
          RowBox[{"H", "[", "t", "]"}]}]}], ")"}]}], " ", "//", " ", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqns", " ", "=", " ", 
     RowBox[{
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"eqnTotal", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "i", ",", " ", "systemSize"}], "}"}]}], "]"}],
       " ", "//", " ", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diffeqs", " ", "=", " ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eqns", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "eqns", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funcs", " ", "=", 
     RowBox[{
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"density", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "i", ",", " ", "systemSize"}], "}"}]}], "]"}],
       " ", "//", " ", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialStateEqs", " ", "=", "  ", 
     RowBox[{
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Rho]", "[", 
           RowBox[{"i", ",", " ", "j"}], "]"}], "[", "0", "]"}], " ", 
         "\[Equal]", " ", 
         RowBox[{"density0", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "i", ",", " ", "systemSize"}], "}"}]}], "]"}],
       "  ", "//", " ", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"diffeqs", ",", " ", "initialStateEqs"}], " ", "}"}], " ", "//",
       " ", "Flatten"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710806678603804*^9, 3.710806714929104*^9}, {
  3.710806896356563*^9, 3.710806903280654*^9}, {3.710806934355884*^9, 
  3.710806968005375*^9}, {3.7108073881839542`*^9, 3.7108074222838917`*^9}, {
  3.7108075593109922`*^9, 3.7108075601851673`*^9}, {3.710807635910696*^9, 
  3.710807660261065*^9}, {3.7108077074614687`*^9, 3.7108077113360043`*^9}, {
  3.71080774633669*^9, 
  3.710807751061191*^9}},ExpressionUUID->"12f2a59e-9e15-4bd5-addf-\
91513dc01701"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"density0", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.711428067610735*^9, 
  3.7114280811018257`*^9}},ExpressionUUID->"73a7d36e-261c-47da-85ff-\
c9c988b6fc75"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.9999994664473241`", "0.`", 
      "0.000730446706578814`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.000730446706578814`", "0.`", 
      "5.335526758302939`*^-7", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.711428069179853*^9, 3.7114280813674717`*^9}, 
   3.711428441486141*^9},ExpressionUUID->"91851744-0e92-4ce3-b16f-\
81f70590a29c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Perform", " ", "simulation"}], " ", "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Store", " ", "T0", " ", "probability", " ", "data", " ", "for", " ", 
     "each", " ", "frequency"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"spin0vec", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", " ", 
       RowBox[{"{", "1", "}"}], ",", " ", 
       RowBox[{"{", "0", "}"}]}], " ", "}"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"tic", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"count", " ", "=", " ", "1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710808082551094*^9, 3.710808192489008*^9}, {
   3.710811730838995*^9, 3.7108117649394493`*^9}, {3.710811798664497*^9, 
   3.710811832839912*^9}, {3.710811947840746*^9, 3.710811951315729*^9}, {
   3.710811992365878*^9, 3.710811995666305*^9}, {3.710812089267189*^9, 
   3.71081212394214*^9}, {3.710812245467698*^9, 3.710812277743506*^9}, {
   3.71081239106879*^9, 3.710812423569036*^9}, {3.71081246769449*^9, 
   3.710812519645073*^9}, {3.7108126934213552`*^9, 3.7108127009473124`*^9}, {
   3.710813863879488*^9, 3.710813867893848*^9}, {3.710813965004546*^9, 
   3.710814026455041*^9}, {3.710814063855279*^9, 3.710814097355245*^9}, {
   3.71081415155678*^9, 3.710814160906396*^9}, {3.710814320910265*^9, 
   3.710814350781163*^9}, {3.710814511508253*^9, 3.710814534061426*^9}, {
   3.710815423964734*^9, 3.710815435756584*^9}, 3.710815470816028*^9, {
   3.710815654592167*^9, 3.7108156740413513`*^9}, {3.710816037993417*^9, 
   3.7108160416426086`*^9}, {3.710816230069763*^9, 3.710816249301928*^9}, {
   3.7108225776207438`*^9, 3.710822640121011*^9}, {3.7108227961478233`*^9, 
   3.7108228218471613`*^9}, {3.710822973873128*^9, 3.7108229900484858`*^9}, {
   3.7108231509005547`*^9, 3.710823180275115*^9}, {3.7108232462502937`*^9, 
   3.7108232561012697`*^9}, {3.710823289426762*^9, 3.71082328955107*^9}, {
   3.710823494626904*^9, 3.7108234948278513`*^9}, {3.7108370209868803`*^9, 
   3.710837045037222*^9}, {3.710837378112514*^9, 3.710837391318425*^9}, {
   3.710850524688867*^9, 3.710850530739335*^9}, {3.7108506000881033`*^9, 
   3.7108506397132053`*^9}, {3.7108514292921953`*^9, 3.710851438843075*^9}, {
   3.710851566317347*^9, 3.710851572542454*^9}, 3.710851732543724*^9, {
   3.710880805204013*^9, 3.710880809631941*^9}, {3.710880887103272*^9, 
   3.710880887245531*^9}, {3.710959816237545*^9, 3.7109598724600763`*^9}, 
   3.710974638782646*^9, 3.7109784053366632`*^9, {3.71098195010562*^9, 
   3.710981950306149*^9}, 3.710985327423554*^9, {3.7109963995272217`*^9, 
   3.7109964416681223`*^9}, {3.710999377197962*^9, 3.710999378046878*^9}, {
   3.71099941737173*^9, 3.710999433197249*^9}, {3.711022829761571*^9, 
   3.711022829930461*^9}, {3.7110544919393597`*^9, 3.711054524788969*^9}, {
   3.711069748165471*^9, 
   3.7110697503133087`*^9}},ExpressionUUID->"e31b831f-f7ea-4e5c-81c2-\
a95b676f2c87"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sol", " ", "=", " ", 
       RowBox[{"NDSolve", "[", " ", 
        RowBox[{
         RowBox[{"params", " ", "/.", " ", 
          RowBox[{"pulseFreq", " ", "\[Rule]", " ", "f"}]}], ",", " ", 
         "funcs", ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "tStart", ",", " ", "tEnd"}], "}"}], ",", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"PrecisionGoal", "\[Rule]", "7"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "7"}], ",", " ", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{",", " ", "\[IndentingNewLine]", 
        RowBox[{"PrecisionGoal", "\[Rule]", "7"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "7"}], ",", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", "\"\<StiffnessSwitching\>\"", "}"}]}], ",", 
        RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Take", " ", "electron", " ", "triplet", " ", "sybsystem", " ", "of", 
        " ", "state"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{"pFunc", " ", "=", " ", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", "spin0vec", "]"}], " ", ".", " ", 
        RowBox[{"Map", "[", " ", 
         RowBox[{"Tr", ",", " ", 
          RowBox[{"Partition", "[", " ", 
           RowBox[{"density", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"systemSize", "/", "3"}], ",", " ", 
              RowBox[{"systemSize", "/", "3"}]}], "}"}]}], "]"}], ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}], " ", ".", " ", "spin0vec"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"tEnd", " ", "-", " ", "tStart"}]], 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pFunc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", "sol"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "tStart", ",", " ", "tEnd"}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"data", ",", " ", 
        RowBox[{"{", 
         RowBox[{"f", ",", " ", 
          RowBox[{"p", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"NotebookDelete", "[", "prw", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"prw", " ", "=", " ", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{
        "\"\<Calculation \>\"", ",", " ", "count", ",", " ", 
         "\"\< out of \>\"", ",", " ", "calculations"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"count", " ", "=", " ", 
       RowBox[{"count", " ", "+", " ", "1"}]}], ";"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "f", ",", " ", "pulseFreqStart", ",", " ", "pulseFreqEnd", ",", " ", 
       "pulseFreqStep"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toc", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ttot", " ", "=", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"toc", "-", "tic"}], ")"}], "/", "60"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqAxis", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"f", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "f", ",", " ", "pulseFreqStart", ",", " ", "pulseFreqEnd", ",", " ", 
       "pulseFreqStep"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", " ", "=", " ", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"data", ",", " ", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"comments", ",", " ", "12"}], "]"}]}], ",", " ", 
    RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
     RowBox[{"{", " ", 
      RowBox[{"\"\<Pulse frequency [Hz]\>\"", ",", " ", "\"\<Prob(T_0)\>\""}],
       "}"}]}], ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.7", ",", " ", "1"}], "}"}]}], ",", " ", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], " ", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Total time taken (min) = \>\"", ",", "ttot", ",", "2"}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.711080998723959*^9, {3.711428432148366*^9, 3.7114284329024677`*^9}, 
   3.711428497467988*^9},ExpressionUUID->"0681ada2-e0cd-4eac-affd-\
a0909b5de625"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"4", ",", "4"}], "]"}], "[", "t", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"5", ",", "5"}], "]"}], "[", "t", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"6", ",", "6"}], "]"}], "[", "t", "]"}]}], "}"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.7110887516349983`*^9, 3.71142416123765*^9, 
  3.711426482302635*^9, 3.711428044048739*^9, 
  3.711428444320752*^9},ExpressionUUID->"311e46a1-8b3a-4c96-8304-\
2806e55f62c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"4", ",", "4"}], "]"}], "[", "t", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"5", ",", "5"}], "]"}], "[", "t", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Rho]", "[", 
      RowBox[{"6", ",", "6"}], "]"}], "[", "t", "]"}]}], "}"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.7110887516349983`*^9, 3.71142416123765*^9, 
  3.711426482302635*^9, 3.711428044048739*^9, 
  3.711428452723139*^9},ExpressionUUID->"8163c833-8cc7-41d8-a1e8-\
6b57a4b6127a"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.711088751473028*^9, 3.711424160974762*^9, 
  3.7114264823011*^9, 3.711428044046986*^9, 
  3.7114284534949427`*^9},ExpressionUUID->"986a6de9-f4c6-4acc-af35-\
fb6b4cd735b4"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{2.867*^9, 1.0000066469425426`}, {2.868*^9, 
      1.0000065167969006`}}]}, {}}, {}, {}, {{}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Pulse frequency [Hz]\"", TraditionalForm], 
    FormBox["\"Prob(T_0)\"", TraditionalForm]},
  AxesOrigin->{2.8669843750000005`*^9, 0.7014999999999999},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Full,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox[
    "\"Pulse that acts on both nuclear spin and electron spin. B0=0.T. \
Frequency Resolution=1000000Hz. Pulse amplitude=7000000Hz\"", 12, 
     StripOnInput -> False], TraditionalForm],
  PlotRange->{{2.867*^9, 2.868*^9}, {0.7, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.711088751473028*^9, 3.711424160974762*^9, 
  3.7114264823011*^9, 3.711428044046986*^9, 
  3.711428453583571*^9},ExpressionUUID->"a67402ac-0442-4b45-96f8-\
cea543c9652b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time taken (min) = \"\>", "\[InvisibleSpace]", 
   "0.19962196666666668`", "\[InvisibleSpace]", "2"}],
  SequenceForm["Total time taken (min) = ", 0.19962196666666668`, 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.7110887516349983`*^9, 3.71142416123765*^9, 
  3.711426482302635*^9, 3.711428044048739*^9, 
  3.711428453584772*^9},ExpressionUUID->"ecc32006-b9f5-48a4-8c04-\
3bf9075235c6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"fileName", "<>", " ", "\"\<_data.csv\>\""}], ",", " ", "data"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"fileName", "<>", " ", "\"\<_plot.pdf\>\""}], ",", " ", "plot"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Save", "[", " ", 
   RowBox[{
    RowBox[{"fileName", " ", "<>", " ", "\"\<_params.dat\>\""}], ",", " ", 
    RowBox[{"{", "  ", 
     RowBox[{
     "comments", ",", " ", "ttot", ",", " ", "pulseAmplitude", ",", 
      "pulsePhase", ",", "pulseFreqStart", ",", "pulseFreqEnd", ",", 
      "calculations", ",", "pulseFreqStep", ",", "\[Gamma]N", ",", 
      "\[Gamma]e", ",", "B0", ",", "\[Omega]s", ",", "\[Omega]I", ",", "Ahf", 
      ",", "Dzfs", ",", "Pzfs", ",", " ", "eSx", ",", " ", "eSz", ",", " ", 
      "Iz", ",", " ", "Hhf", ",", " ", "Hnv", ",", " ", "Hcop"}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.710999431121374*^9},ExpressionUUID->"514ca1f1-feb7-48e8-a0f9-\
263b14a947b5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"data", " ", "=", " ", 
    RowBox[{
    "Import", "[", 
     "\"\<results/nv_center_simulation2017-08-05T01.12.38_data.csv\>\"", 
     "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\<results/nv_center_simulation2017-08-05T01.12.38_data.csv\>\"", ",", 
     " ", "data"}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"plot", " ", "=", " ", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"data", ",", " ", 
       RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
        RowBox[{"{", " ", 
         RowBox[{
         "\"\<Pulse frequency [Hz]\>\"", ",", " ", "\"\<Prob(T_0)\>\""}], 
         "}"}]}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.37", ",", " ", "1"}], "}"}]}], " ", ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "5", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
      "\"\<results/nv_center_simulation2017-08-05T01.12.38_plot.pdf\>\"", ",",
        " ", "plot"}], "]"}]}]}], ";"}], "  ", "*)"}]], "Input",
 CellChangeTimes->{{3.7108516265855494`*^9, 3.7108516480071173`*^9}, {
   3.710879150747184*^9, 3.710879178640152*^9}, 3.71087925980028*^9, {
   3.71087959262187*^9, 3.710879597412341*^9}, 3.71087963310456*^9, 
   3.710879732997981*^9, {3.7108797680808372`*^9, 3.7108798148272457`*^9}, 
   3.710880880462964*^9, 
   3.7109993583381433`*^9},ExpressionUUID->"9490f32b-9a35-4233-8d99-\
3f91bb84c980"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7108516500609617`*^9, 3.710851722696393*^9}, {
  3.710879308907813*^9, 3.71087931458377*^9}, {3.710879553372398*^9, 
  3.710879577154264*^9}, {3.710879683282827*^9, 
  3.710879766847363*^9}},ExpressionUUID->"08cf9d32-731a-4b64-8983-\
712c426d7001"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plot", " ", "=", " ", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"data", ",", " ", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"comments", ",", " ", "12"}], "]"}]}], ",", " ", 
    RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
     RowBox[{"{", " ", 
      RowBox[{"\"\<Pulse frequency [Hz]\>\"", ",", " ", "\"\<Prob(T_0)\>\""}],
       "}"}]}], ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.8748", "*", 
          SuperscriptBox["10", "9"]}], ",", 
         RowBox[{"2.8750", "*", 
          SuperscriptBox["10", "9"]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0.75", ",", " ", "1"}], "}"}]}], "}"}]}], ",", " ", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}], " ", ",", " ", 
    RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7109992976711884`*^9, 3.710999410475164*^9}, {
  3.710999459773294*^9, 3.7109994725720673`*^9}, {3.711005939725882*^9, 
  3.7110059588005867`*^9}, {3.7110228205853252`*^9, 3.711022820745199*^9}, {
  3.711023467315311*^9, 
  3.711023524313689*^9}},ExpressionUUID->"5d9f510f-a95d-417a-809c-\
98f4fff9a83b"],

Cell[BoxData[
 GraphicsBox[{{}, 
   GraphicsComplexBox[{{2.867*^9, 1.}, {2.881*^9, 
    1.}}, {}], {}, {}, {{}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Pulse frequency [Hz]\"", TraditionalForm], 
    FormBox["\"Prob(T_0)\"", TraditionalForm]},
  AxesOrigin->{2.874801*^9, 0.75125},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Full,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox[
    "\"Pulse that acts on both nuclear spin and electron spin. B0=0.T. \
Frequency Resolution=1000000Hz. Pulse amplitude=7000000Hz\"", 12, 
     StripOnInput -> False], TraditionalForm],
  PlotRange->{{2.8748*^9, 2.875*^9}, {0.75, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.710999329445812*^9, 3.710999410803062*^9}, {
   3.7109994644920273`*^9, 3.710999473025226*^9}, 3.7109995036694508`*^9, 
   3.7110025024477873`*^9, 3.711005240162244*^9, {3.711005954376896*^9, 
   3.711005967705151*^9}, 3.71100899059697*^9, 3.711023002620556*^9, {
   3.711023480899001*^9, 3.7110235246281157`*^9}, 3.711065303238525*^9, 
   3.711088754903708*^9, 3.711426483582715*^9, 
   3.711428046220832*^9},ExpressionUUID->"ce48580a-f1fe-4aeb-85e9-\
9fcc4d8f948a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.711070673210466*^9, 3.711070673460239*^9}, 
   3.711072261184494*^9},ExpressionUUID->"5a663196-c99f-49b5-8f4b-\
c113f4a42c54"]
},
WindowSize->{959, 1027},
WindowMargins->{{Automatic, 3}, {1, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 819, 20, 102, "Input", "ExpressionUUID" -> \
"601682c8-0029-4b05-a483-75230eaf7c4a"],
Cell[1380, 42, 5030, 109, 538, "Input", "ExpressionUUID" -> \
"d6b8bbba-177c-439f-b018-febaeff2810a"],
Cell[6413, 153, 4154, 104, 313, "Input", "ExpressionUUID" -> \
"e1329ae7-19b1-408f-95d9-e9481b61a566"],
Cell[10570, 259, 3754, 99, 465, "Input", "ExpressionUUID" -> \
"05f76c44-2fcb-49d1-a396-a70c2752e3ab"],
Cell[CellGroupData[{
Cell[14349, 362, 3889, 90, 396, "Input", "ExpressionUUID" -> \
"37922a1c-c325-4d4e-a563-6ea74af87a88"],
Cell[18241, 454, 1631, 37, 224, "Output", "ExpressionUUID" -> \
"d8c9e8eb-2dc0-4b41-ac0c-4e67b5745d5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19909, 496, 196, 4, 32, "Input", "ExpressionUUID" -> \
"e938f197-365c-44a9-9427-74231aa063e4"],
Cell[20108, 502, 1210, 34, 119, "Output", "ExpressionUUID" -> \
"2e1c3051-ae60-46b5-be01-1ee68cdff22a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21355, 541, 192, 4, 32, "Input", "ExpressionUUID" -> \
"9ed35f94-c0fb-4416-a2ba-87aa12648688"],
Cell[21550, 547, 551, 12, 71, "Output", "ExpressionUUID" -> \
"c3ee4df5-cef8-4d7e-a5b8-37973b799786"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22138, 564, 321, 6, 32, "Input", "ExpressionUUID" -> \
"f74fb202-a85c-486e-b2ea-93157dfc1da6"],
Cell[22462, 572, 1453, 30, 188, "Output", "ExpressionUUID" -> \
"857b5152-ebd5-44e8-b0ad-c6f33cabdb1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23952, 607, 508, 13, 32, "Input", "ExpressionUUID" -> \
"0a91147d-77f7-405a-a68a-a33c34bb5ee7"],
Cell[24463, 622, 1504, 30, 220, "Output", "ExpressionUUID" -> \
"d95cc162-f615-4461-8815-67851b1a40cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26004, 657, 1845, 46, 190, "Input", "ExpressionUUID" -> \
"7ac6f8f5-ef3d-4605-9dba-77f21b0ddc63"],
Cell[27852, 705, 12018, 324, 197, "Output", "ExpressionUUID" -> \
"aaf79f3f-50c1-45f1-b7e0-cdf6768a1486"]
}, Open  ]],
Cell[39885, 1032, 1554, 39, 102, "Input", "ExpressionUUID" -> \
"38f60a8c-8f33-4daf-a785-138d0fc5ea11"],
Cell[41442, 1073, 599, 16, 34, "Input", "ExpressionUUID" -> \
"08bd9d09-be0d-4fe1-804b-9981ec2b57f4"],
Cell[CellGroupData[{
Cell[42066, 1093, 592, 13, 56, "Input", "ExpressionUUID" -> \
"98d51e81-3d6f-44b6-8a49-da2fe2cffc58"],
Cell[42661, 1108, 4063, 99, 247, "Output", "ExpressionUUID" -> \
"71a67c95-da0c-4c26-89a4-e53615b780ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46761, 1212, 2278, 58, 257, "Input", "ExpressionUUID" -> \
"b5b816e3-5546-4264-bcae-aec2deba4692"],
Cell[49042, 1272, 421, 7, 32, "Output", "ExpressionUUID" -> \
"8f6c1270-7659-472c-bb31-9986382fe0db"],
Cell[49466, 1281, 443, 8, 34, "Output", "ExpressionUUID" -> \
"442d8346-bbaf-478d-97b2-0b80ab3f1673"],
Cell[49912, 1291, 428, 7, 34, "Output", "ExpressionUUID" -> \
"edb03dfc-24be-4236-b7da-41d81c275b76"],
Cell[50343, 1300, 445, 8, 34, "Output", "ExpressionUUID" -> \
"2e0a22c5-f999-4ca4-ae3c-24e7dc04633f"]
}, Open  ]],
Cell[50803, 1311, 3532, 92, 237, "Input", "ExpressionUUID" -> \
"12f2a59e-9e15-4bd5-addf-91513dc01701"],
Cell[CellGroupData[{
Cell[54360, 1407, 204, 4, 32, "Input", "ExpressionUUID" -> \
"73a7d36e-261c-47da-85ff-c9c988b6fc75"],
Cell[54567, 1413, 1417, 29, 192, "Output", "ExpressionUUID" -> \
"91851744-0e92-4ce3-b16f-81f70590a29c"]
}, Open  ]],
Cell[55999, 1445, 3206, 58, 147, "Input", "ExpressionUUID" -> \
"e31b831f-f7ea-4e5c-81c2-a95b676f2c87"],
Cell[CellGroupData[{
Cell[59230, 1507, 4950, 121, 656, "Input", "ExpressionUUID" -> \
"0681ada2-e0cd-4eac-affd-a0909b5de625"],
Cell[CellGroupData[{
Cell[64205, 1632, 582, 17, 26, "Print", "ExpressionUUID" -> \
"311e46a1-8b3a-4c96-8304-2806e55f62c9"],
Cell[64790, 1651, 582, 17, 26, "Print", "ExpressionUUID" -> \
"8163c833-8cc7-41d8-a1e8-6b57a4b6127a"]
}, Open  ]],
Cell[65387, 1671, 228, 4, 32, "Output", "ExpressionUUID" -> \
"986a6de9-f4c6-4acc-af35-fb6b4cd735b4"],
Cell[65618, 1677, 1736, 44, 434, "Output", "ExpressionUUID" -> \
"a67402ac-0442-4b45-96f8-cea543c9652b"],
Cell[67357, 1723, 451, 9, 24, "Print", "ExpressionUUID" -> \
"ecc32006-b9f5-48a4-8c04-3bf9075235c6"]
}, Open  ]],
Cell[67823, 1735, 1107, 26, 148, "Input", "ExpressionUUID" -> \
"514ca1f1-feb7-48e8-a0f9-263b14a947b5"],
Cell[68933, 1763, 1523, 36, 126, "Input", "ExpressionUUID" -> \
"9490f32b-9a35-4233-8d99-3f91bb84c980"],
Cell[70459, 1801, 297, 5, 32, "Input", "ExpressionUUID" -> \
"08cf9d32-731a-4b64-8983-712c426d7001"],
Cell[CellGroupData[{
Cell[70781, 1810, 1233, 29, 95, "Input", "ExpressionUUID" -> \
"5d9f510f-a95d-417a-809c-98f4fff9a83b"],
Cell[72017, 1841, 1836, 44, 434, "Output", "ExpressionUUID" -> \
"ce48580a-f1fe-4aeb-85e9-9fcc4d8f948a"]
}, Open  ]],
Cell[73868, 1888, 175, 3, 32, "Input", "ExpressionUUID" -> \
"5a663196-c99f-49b5-8f4b-c113f4a42c54"]
}
]
*)

