(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    136243,       3510]
NotebookOptionsPosition[    125150,       3236]
NotebookOutlinePosition[    125485,       3251]
CellTagsIndexPosition[    125442,       3248]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.710804308136487*^9, 3.710804308444024*^9}, {
   3.710851376716381*^9, 3.7108513846410437`*^9}, 
   3.71087924794349*^9},ExpressionUUID->"610f21b9-8da0-4c10-80f2-\
3ec1ae10d782"],

Cell[CellGroupData[{

Cell["NV-Centre ESR Simulation", "Title",
 CellChangeTimes->{{3.711324864628573*^9, 
  3.711324868203494*^9}},ExpressionUUID->"17c79617-3f48-40ff-b1ce-\
b7c110d0d8fb"],

Cell[TextData[{
 "Construct a Hamiltonian of the form:\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["H", "^"], " ", "=", " "}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c2e7a3d7-c364-4e5a-963c-e9766a9b9747"]
}], "Text",
 CellChangeTimes->{{3.711324872603446*^9, 3.711324902829576*^9}, {
  3.7113250806549*^9, 
  3.711325096754764*^9}},ExpressionUUID->"5b33cbac-42c9-42c1-b6d5-\
8dacdde316ab"],

Cell["\<\
Features to add:
- Enable truncated spin matrices
- Visualisation for the angular momentum conserving transitions
- Visualisation of the energies of the NV-center subsystem states\
\>", "Text",
 CellChangeTimes->{{3.7116820573570337`*^9, 3.711682072188808*^9}, {
  3.711683093108923*^9, 3.711683103658929*^9}, {3.711683144309466*^9, 
  3.711683170259389*^9}},ExpressionUUID->"e4bb5524-2509-4001-87ac-\
d45eb8ab1907"],

Cell[CellGroupData[{

Cell["Initialisation", "Chapter",
 CellChangeTimes->{{3.711246464665057*^9, 
  3.711246469190033*^9}},ExpressionUUID->"19fded08-3617-4157-ba0a-\
09242c9a372f"],

Cell[CellGroupData[{

Cell["NV-Centre constants", "Section",
 CellChangeTimes->{{3.711246475469863*^9, 3.7112464805650463`*^9}, {
  3.711325778357893*^9, 
  3.711325780958082*^9}},ExpressionUUID->"dee25e60-2aa0-4c81-a7a7-\
edd5bf678d92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]N", " ", "=", " ", 
    RowBox[{"19.331", "*", 
     SuperscriptBox["10", "6"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Gyromagnetic", " ", "ratio", " ", "for", 
    SuperscriptBox[" ", "14"], 
    RowBox[{"N", " ", "[", 
     RowBox[{
      SuperscriptBox["s", 
       RowBox[{"-", "1"}]], 
      SuperscriptBox["T", 
       RowBox[{"-", "1"}]]}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]e", " ", "=", " ", 
    RowBox[{"1.7609", "*", 
     SuperscriptBox["10", "11"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Gyromagnetic", " ", "ratio", " ", "for", " ", "e"}], "-", " ", 
    RowBox[{"[", 
     RowBox[{"rad", " ", 
      SuperscriptBox["s", 
       RowBox[{"-", "1"}]], 
      SuperscriptBox["T", 
       RowBox[{"-", "1"}]]}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ahf", " ", "=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2.1"}], "*", 
       SuperscriptBox["10", "6"]}], ",", " ", 
      RowBox[{
       RowBox[{"-", "2.1"}], "*", 
       SuperscriptBox["10", "6"]}], ",", " ", 
      RowBox[{
       RowBox[{"-", "2.16"}], "*", 
       SuperscriptBox["10", "6"]}]}], " ", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Hyperfine", " ", "interaction", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", ",", "y", ",", "z"}], ")"}], " ", "[", "Hz", "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dzfs", " ", "=", " ", 
    RowBox[{"2870", "*", 
     SuperscriptBox["10", "6"]}]}], " ", ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Zero", "-", "field", "-", 
    RowBox[{"splitting", " ", "for", " ", "electron", " ", 
     RowBox[{"triplet", " ", "[", "Hz", "]"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pzfs", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", "4.95"}], "*", 
     SuperscriptBox["10", "6"]}]}], " ", ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Zero", "-", "field", "-", 
    RowBox[{"splitting", " ", "for", 
     SuperscriptBox[" ", "14"], 
     RowBox[{"N", " ", "[", "Hz", "]"}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.711246482190489*^9, 3.711246486366794*^9}, {
  3.711325793283394*^9, 3.711325830133637*^9}, {3.7113258640588427`*^9, 
  3.711325868783738*^9}, {3.711326560306879*^9, 3.711326570719633*^9}, {
  3.7113275313873997`*^9, 
  3.7113275457614603`*^9}},ExpressionUUID->"25e65bac-7b78-4e63-bb19-\
0c600059ffd8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.7112464080395737`*^9, 
  3.711246409089758*^9}},ExpressionUUID->"33751f26-5118-427d-bd1d-\
36bd71e4f594"],

Cell[CellGroupData[{

Cell["GetSubsystemA[density, subSystemSize]", "Subsubsection",
 CellChangeTimes->{{3.711247465344591*^9, 
  3.711247479721534*^9}},ExpressionUUID->"25d73bb2-3e52-43fc-8a4b-\
6fc858a85465"],

Cell[TextData[{
 "For a density matrix \[Rho] in the space ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["A", "1"], " ", "\[TensorProduct]", " ", 
      SubscriptBox["A", "2"], " ", "\[TensorProduct]"}], " ", "..."}], " ", 
    "\[TensorProduct]", " ", 
    SubscriptBox["A", "n"]}], TraditionalForm]],ExpressionUUID->
  "df348552-1ea0-4614-8d9c-425b6528e2fc"],
 ", the function will return the reduced density matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", 
    SubscriptBox["A", "1"]], TraditionalForm]],ExpressionUUID->
  "0078e50e-edcb-4bc0-abb2-cbdaebf14d44"],
 "."
}], "Text",
 CellChangeTimes->{
  3.711246383915731*^9, {3.711246853118487*^9, 3.711246868241654*^9}, {
   3.711247459044855*^9, 
   3.711247481744979*^9}},ExpressionUUID->"795b5723-e2c3-4a8c-98c1-\
503eb98ddfe7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetSubsystemA", "[", 
    RowBox[{"density_", ",", "subSystemSize_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{"Tr", ",", 
     RowBox[{"Partition", "[", 
      RowBox[{"density", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "density", "]"}], "/", "subSystemSize"}], 
         ",", 
         RowBox[{
          RowBox[{"Length", "[", "density", "]"}], "/", "subSystemSize"}]}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7112469202170153`*^9, 
  3.711246928944817*^9}},ExpressionUUID->"e5a58848-be0e-4033-b4f8-\
24ae9bf1d61d"]
}, Closed]],

Cell[CellGroupData[{

Cell["FullHilbertSpaceOperator[operators, hilbertSubspaces]", "Subsubsection",
 CellChangeTimes->{{3.7112503033085012`*^9, 3.711250312058639*^9}, {
  3.711252027944312*^9, 3.711252036042594*^9}, {3.711328578416769*^9, 
  3.711328588873211*^9}},ExpressionUUID->"86b46845-37ea-42fb-b575-\
376c9dc7b175"],

Cell[TextData[{
 "Returns the matrix representation of an operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox[
       OverscriptBox["O", "^"], "1"], "\[TensorProduct]", 
      SubscriptBox[
       OverscriptBox["O", "^"], "2"], "\[TensorProduct]"}], "..."}], 
    "\[TensorProduct]", 
    SubscriptBox[
     OverscriptBox["O", "^"], "n"]}], TraditionalForm]],ExpressionUUID->
  "b6f6a807-3f06-4c72-b295-19bf6ff65d05"],
 ". The variable ",
 StyleBox["operators",
  FontSlant->"Italic"],
 " should contain a list of pairs, where the second element is the operator \
acting on subsystem ",
 StyleBox["i",
  FontSlant->"Italic"],
 ", and where the first element is ",
 StyleBox["i",
  FontSlant->"Italic"],
 ". ",
 StyleBox["hilbertSubspaces",
  FontSlant->"Italic"],
 " is a list of the dimensions of the subspaces. Any unspecified operators \
for the subspaces will be replaced by an identity matrix of the appropriate \
size.F"
}], "Text",
 CellChangeTimes->{{3.7112503133353853`*^9, 3.711250314641279*^9}, {
  3.71125218036804*^9, 3.711252454670231*^9}, {3.711252582470558*^9, 
  3.7112527291967*^9}, {3.711255628136774*^9, 
  3.71125564903785*^9}},ExpressionUUID->"e561a6a7-bf75-4857-90dc-\
9764ea1cfb32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FullHilbertSpaceOperator", "[", 
     RowBox[{
      RowBox[{"elem_", " ", "/;", " ", 
       RowBox[{"IntegerQ", "[", 
        RowBox[{"elem", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", " ", 
      "hilbertSubspaces_"}], "]"}], " ", ":=", " ", 
    RowBox[{"FullHilbertSpaceOperator", "[", 
     RowBox[{
      RowBox[{"{", "elem", "}"}], ",", " ", "hilbertSubspaces"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FullHilbertSpaceOperator", "[", 
    RowBox[{
     RowBox[{"ops_:", 
      RowBox[{"{", " ", 
       RowBox[{"elem_", " ", "/;", " ", 
        RowBox[{
         RowBox[{"IntegerQ", "[", 
          RowBox[{"elem", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", ".."}]}], "}"}]}], " ",
      ",", " ", "hilbertSubspaces_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"operator", " ", "=", " ", 
        RowBox[{"{", "1", "}"}]}], ",", " ", "next"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"next", " ", "=", " ", 
          RowBox[{"Select", "[", " ", 
           RowBox[{"ops", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "i"}], 
             " ", "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"next", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"next", " ", "\[Equal]", " ", 
             RowBox[{"{", "}"}]}], ",", " ", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"hilbertSubspaces", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"next", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"operator", " ", "=", " ", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"operator", ",", " ", "next"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "hilbertSubspaces", "]"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "operator"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.711250315912553*^9, 3.711250399109428*^9}, {
   3.7112506194604483`*^9, 3.71125063371056*^9}, {3.711250669986174*^9, 
   3.711250696135941*^9}, {3.711251204563671*^9, 3.7112512904639606`*^9}, {
   3.71125132728902*^9, 3.711251328414373*^9}, {3.711251415440144*^9, 
   3.711251561315838*^9}, {3.7112516086418953`*^9, 3.7112517283167267`*^9}, {
   3.711251767967095*^9, 3.711251768991972*^9}, {3.711251838542386*^9, 
   3.7112518768423843`*^9}, {3.711259529908712*^9, 3.7112595384435577`*^9}, {
   3.711327766337919*^9, 3.711327803463174*^9}, {3.711328395341578*^9, 
   3.711328463041832*^9}, {3.711328508292014*^9, 3.711328509567018*^9}, {
   3.711328588832336*^9, 3.711328588834688*^9}, {3.7113286462429113`*^9, 
   3.7113286761181087`*^9}, {3.711328727069264*^9, 3.711328743120091*^9}, {
   3.711328849019457*^9, 3.711328851595138*^9}, {3.7113289992452917`*^9, 
   3.711329034945003*^9}, 3.711329241771822*^9, {3.7113293786723223`*^9, 
   3.711329390771956*^9}, {3.711329431797962*^9, 3.7113294513724003`*^9}, {
   3.711329638024338*^9, 3.7113296878750753`*^9}, {3.711329728949736*^9, 
   3.7113297762502213`*^9}, {3.711329929750545*^9, 3.711329931450839*^9}, {
   3.711329974801046*^9, 
   3.711330025450795*^9}},ExpressionUUID->"635c7b3f-cbfc-4ed4-b2a8-\
549fd15a5ae3"]
}, Closed]],

Cell[CellGroupData[{

Cell["SpinMatrixX[spin]", "Subsubsection",
 CellChangeTimes->{
  3.7112475193966713`*^9},ExpressionUUID->"5301936c-f3f8-4ffd-8c79-\
df6132f5e5d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinMatrixX", "[", "spin_", "]"}], " ", ":=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{RowBox[{"i", ",", 
           RowBox[{"j", "+", "1"}]}]},
        "KroneckerDeltaSeq"], "  ", "+", " ", 
       TemplateBox[{RowBox[{
           RowBox[{"i", "+", "1"}], ",", "j"}]},
        "KroneckerDeltaSeq"]}], ")"}], 
     FractionBox["1", "2"], 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"spin", 
        RowBox[{"(", 
         RowBox[{"spin", "+", "1"}], ")"}]}], " ", "-", " ", 
       RowBox[{"i", "*", "j"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "spin", ",", " ", 
      RowBox[{"-", "spin"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "spin", ",", " ", 
      RowBox[{"-", "spin"}], ",", " ", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711246936267289*^9, 3.711247065043171*^9}, {
  3.711247121493473*^9, 3.711247173083146*^9}, {3.7112473287946863`*^9, 
  3.711247357069614*^9}, {3.711247390896294*^9, 3.711247417420208*^9}, {
  3.7112476747215*^9, 3.7112476829226503`*^9}, {3.711247722896837*^9, 
  3.711247725396614*^9}, {3.7112477718220263`*^9, 
  3.711247774146935*^9}},ExpressionUUID->"01b676cd-188a-4f94-b281-\
69c60a5bc0ee"]
}, Closed]],

Cell[CellGroupData[{

Cell["SpinMatrixY[spin]", "Subsubsection",
 CellChangeTimes->{{3.7112475193966713`*^9, 
  3.711247544069911*^9}},ExpressionUUID->"303ecb3b-13b4-4715-b6d7-\
3d0096134513"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinMatrixY", "[", "spin_", "]"}], " ", ":=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{RowBox[{"i", ",", 
           RowBox[{"j", "+", "1"}]}]},
        "KroneckerDeltaSeq"], "  ", "-", " ", 
       TemplateBox[{RowBox[{
           RowBox[{"i", "+", "1"}], ",", "j"}]},
        "KroneckerDeltaSeq"]}], ")"}], 
     FractionBox["1", 
      RowBox[{"2", " ", "I"}]], 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"spin", 
        RowBox[{"(", 
         RowBox[{"spin", "+", "1"}], ")"}]}], " ", "-", " ", 
       RowBox[{"i", "*", "j"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "spin", ",", " ", 
      RowBox[{"-", "spin"}], ",", " ", 
      RowBox[{"-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", " ", "spin", ",", " ", 
      RowBox[{"-", "spin"}], ",", " ", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711246936267289*^9, 3.711247065043171*^9}, {
  3.711247121493473*^9, 3.711247173083146*^9}, {3.7112473287946863`*^9, 
  3.711247357069614*^9}, {3.711247390896294*^9, 3.711247417420208*^9}, {
  3.711247548495491*^9, 3.711247557970296*^9}, {3.711247670671645*^9, 
  3.711247684822441*^9}, {3.711247720196795*^9, 
  3.711247726421524*^9}},ExpressionUUID->"043b02bc-cde3-498c-bea6-\
9b6331b83e5a"]
}, Closed]],

Cell[CellGroupData[{

Cell["SpinMatrixZ[spin]", "Subsubsection",
 CellChangeTimes->{3.7112475193966713`*^9, 
  3.711247587219841*^9},ExpressionUUID->"91fa8865-d8cd-4e67-823b-\
c5a42f667ca6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinMatrixZ", "[", "spin_", "]"}], " ", ":=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     TemplateBox[{RowBox[{"i", ",", "j"}]},
      "KroneckerDeltaSeq"], "  ", "j"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "spin", ",", " ", 
      RowBox[{"-", "spin"}], ",", " ", 
      RowBox[{"-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", " ", "spin", ",", " ", 
      RowBox[{"-", "spin"}], ",", " ", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711246936267289*^9, 3.711247065043171*^9}, {
  3.711247121493473*^9, 3.711247173083146*^9}, {3.7112473287946863`*^9, 
  3.711247357069614*^9}, {3.711247390896294*^9, 3.711247417420208*^9}, {
  3.71124756779639*^9, 3.711247585046797*^9}, {3.711247688347076*^9, 
  3.7112477193224077`*^9}},ExpressionUUID->"16641524-6787-4236-8a48-\
029b6eddd391"]
}, Closed]],

Cell[CellGroupData[{

Cell["SpinMatrix[j, spin]", "Subsubsection",
 CellChangeTimes->{{3.711320785667447*^9, 
  3.711320799061265*^9}},ExpressionUUID->"6be122a3-c5c7-40f9-9b25-\
b437d78d96c3"],

Cell[TextData[{
 "Returns the spin matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["S", "^"], "j"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1daf7a0f-2044-4e23-bfdf-2c9b3fc9e1c3"]
}], "Text",
 CellChangeTimes->{{3.71132080603605*^9, 
  3.7113208281863337`*^9}},ExpressionUUID->"c245072e-35a8-49f6-8415-\
ca0f429521fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SpinMatrix", "[", 
    RowBox[{
     RowBox[{"j_", "/;", " ", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"j", "-", "1"}], ",", " ", "3"}], "]"}], " ", "\[Equal]", 
       " ", "0"}]}], ",", " ", "spin_"}], "]"}], " ", ":=", " ", 
   RowBox[{"SpinMatrixX", "[", "spin", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpinMatrix", "[", 
    RowBox[{
     RowBox[{"j_", "/;", " ", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"j", "-", "1"}], ",", " ", "3"}], "]"}], " ", "\[Equal]", 
       " ", "1"}]}], ",", " ", "spin_"}], "]"}], " ", ":=", " ", 
   RowBox[{"SpinMatrixY", "[", "spin", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpinMatrix", "[", 
    RowBox[{
     RowBox[{"j_", "/;", " ", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"j", "-", "1"}], ",", " ", "3"}], "]"}], " ", "\[Equal]", 
       " ", "2"}]}], ",", " ", "spin_"}], "]"}], " ", ":=", " ", 
   RowBox[{"SpinMatrixZ", "[", "spin", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.711320832962266*^9, 3.7113208384865913`*^9}, {
  3.711320959212143*^9, 3.711321077062944*^9}, {3.711321144888558*^9, 
  3.711321162488318*^9}, {3.711321362365596*^9, 3.7113213637397127`*^9}, {
  3.71132140138966*^9, 
  3.711321432415269*^9}},ExpressionUUID->"bd481476-810a-4014-8d79-\
99eb53767c82"]
}, Closed]],

Cell[CellGroupData[{

Cell["SpinSpinHamiltonian[spins, couplings]", "Subsubsection",
 CellChangeTimes->{{3.711252791396171*^9, 3.711252821371649*^9}, {
  3.711326818006925*^9, 
  3.711326819256988*^9}},ExpressionUUID->"34dee551-86ae-4a59-8ceb-\
e32097ee74ba"],

Cell[TextData[{
 "Returns a Hamiltonian of the form ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "ij"], 
    RowBox[{
     SubscriptBox["k", "ij"], " ", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["S", "^"], "i"], ".", " ", 
      SubscriptBox[
       OverscriptBox["S", "^"], "j"]}]}]}], TraditionalForm]],ExpressionUUID->
  "87b5385c-44c4-45c0-83e3-6cda258086dd"],
 ".\n\nArguments:\n\n",
 StyleBox["spins",
  FontSlant->"Italic"],
 " - List of spins in the system \n",
 StyleBox["couplings",
  FontSlant->"Italic"],
 " - List of elements of the form {",
 StyleBox["indexOfSpin1 \[RightArrow] indexOfSpin2, couplingConstant}",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.7112543972717047`*^9, 3.711254397272438*^9}, {
  3.711257907597528*^9, 3.711258054923711*^9}, {3.711324649452592*^9, 
  3.711324705602903*^9}, {3.7113268289319143`*^9, 3.711326881882724*^9}, {
  3.711326932482757*^9, 
  3.711326954282831*^9}},ExpressionUUID->"bfc14f1d-fd16-4a23-bd9e-\
54ed6d012191"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpinSpinHamiltonian", "[", 
    RowBox[{"spins_", ",", " ", 
     RowBox[{"couplings_", " ", ":", " ", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"_", " ", "\[Rule]", " ", "_"}], ",", "  ", "_"}], "}"}], 
        " ", ".."}], "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "H", ",", " ", "spin1", ",", " ", "spin2", ",", " ", "sx", ",", " ", 
       "sy", ",", "sz", ",", " ", "i", ",", " ", "j", ",", " ", "coeffs"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Times", " ", "@@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "spins"}], " ", "+", " ", "1"}], ")"}]}], ",", 
           RowBox[{"Times", " ", "@@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "spins"}], " ", "+", " ", "1"}], ")"}]}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"i", " ", "=", " ", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
         
         RowBox[{"j", " ", "=", " ", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
         
         RowBox[{"coeffs", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NumberQ", "[", 
            RowBox[{"c", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"coeffs", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{"c", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{"c", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"c", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "\[Equal]", " ", 
            "3"}], ",", "\[IndentingNewLine]", 
           RowBox[{"coeffs", " ", "=", " ", 
            RowBox[{"c", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"H", " ", "=", " ", 
          RowBox[{"H", " ", "+", " ", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coeffs", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{
               "FullHilbertSpaceOperator", "[", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"i", "\[Rule]", "  ", 
                  RowBox[{"SpinMatrix", "[", 
                   RowBox[{"k", ",", " ", 
                    RowBox[{"spins", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"2", "*", "spins"}], "+", "1"}]}], 
                "\[IndentingNewLine]", "]"}], " ", ".", 
               RowBox[{
               "FullHilbertSpaceOperator", "[", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"j", " ", "\[Rule]", "  ", 
                  RowBox[{"SpinMatrix", "[", 
                   RowBox[{"k", ",", " ", 
                    RowBox[{"spins", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"2", "*", "spins"}], "+", "1"}]}], 
                "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ",", 
             
             RowBox[{"{", 
              RowBox[{"k", ",", " ", "1", ",", " ", "3"}], "}"}]}], "]"}]}]}],
          ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", " ", "couplings"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "H"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7112528379966288`*^9, 3.711252865897253*^9}, {
   3.711255096308413*^9, 3.711255096422159*^9}, {3.711255247759308*^9, 
   3.711255248959257*^9}, {3.711255664712302*^9, 3.7112556683864183`*^9}, {
   3.7112558932374887`*^9, 3.711255905312488*^9}, {3.7112559443377037`*^9, 
   3.711255956462689*^9}, {3.7112561022385473`*^9, 3.711256103663726*^9}, {
   3.711256170138886*^9, 3.7112561899393873`*^9}, {3.7112563593151283`*^9, 
   3.711256369990102*^9}, {3.711256469515583*^9, 3.711256480040628*^9}, {
   3.711256877467579*^9, 3.711256896767901*^9}, {3.7112571714192057`*^9, 
   3.711257185344116*^9}, {3.711257233769413*^9, 3.7112573451202993`*^9}, {
   3.711257441770548*^9, 3.711257449071035*^9}, {3.7112575222713213`*^9, 
   3.711257606996942*^9}, {3.711257693672153*^9, 3.711257760747469*^9}, {
   3.711257801447493*^9, 3.711257872223435*^9}, {3.7112581677251987`*^9, 
   3.711258177400238*^9}, {3.71125821432508*^9, 3.711258236275371*^9}, {
   3.711258266300281*^9, 3.7112582796004877`*^9}, {3.71125831767566*^9, 
   3.711258323503042*^9}, {3.711258393101132*^9, 3.711258403776866*^9}, {
   3.711258564252182*^9, 3.711258570452733*^9}, {3.71132148294127*^9, 
   3.711321503966343*^9}, {3.711321570341626*^9, 3.711321616916581*^9}, {
   3.711321805317834*^9, 3.711321859044196*^9}, {3.711321960419685*^9, 
   3.711321960493887*^9}, {3.711321992069292*^9, 3.711322040869083*^9}, 
   3.7113222399709883`*^9, {3.711322298421002*^9, 3.711322327346368*^9}, {
   3.711322781199491*^9, 3.7113227837986107`*^9}, 3.711323085649478*^9, {
   3.711323147224002*^9, 3.711323150424623*^9}, {3.7113244005528316`*^9, 
   3.71132440762891*^9}, {3.711326959809239*^9, 3.711326968909059*^9}, {
   3.7113271079600487`*^9, 3.711327189035269*^9}, {3.711328588845521*^9, 
   3.7113285888474703`*^9}, {3.711330103401993*^9, 3.7113301333517923`*^9}, {
   3.7113311988601313`*^9, 3.7113311989826937`*^9}, {3.71133125785811*^9, 
   3.711331331708444*^9}, {3.711331729811345*^9, 3.711331735013721*^9}, {
   3.711332177338957*^9, 
   3.711332206389728*^9}},ExpressionUUID->"e513bfb5-39ed-492d-a7e2-\
e9215bf46043"]
}, Closed]],

Cell[CellGroupData[{

Cell["ZeemanHamiltonian[spins, \[Omega]s]", "Subsubsection",
 CellChangeTimes->{{3.7113275765610456`*^9, 3.711327593586032*^9}, {
  3.711327667361598*^9, 
  3.7113276814866657`*^9}},ExpressionUUID->"280f5d62-9654-43c9-b642-\
57158dcb82dd"],

Cell["Returns a Zeeman Hamiltonian of the specified spins.", "Text",
 CellChangeTimes->{{3.7113276096862183`*^9, 3.711327609861225*^9}, {
  3.711327867412642*^9, 
  3.711327879987932*^9}},ExpressionUUID->"32702ccc-a7fc-433f-8ebf-\
e8df3520487c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZeemanHamiltonian", "[", 
   RowBox[{"spins_", ",", " ", "\[Omega]s_"}], "]"}], " ", ":=", 
  RowBox[{"Sum", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"FullHilbertSpaceOperator", "[", 
      RowBox[{
       RowBox[{"i", " ", "\[Rule]", "  ", 
        RowBox[{"SpinMatrixZ", "[", 
         RowBox[{"spins", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"2", "spins"}], "+", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "spins", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711327610962199*^9, 3.711327622961396*^9}, {
   3.711327686336863*^9, 3.711327752762477*^9}, {3.7113278200135403`*^9, 
   3.711327862638773*^9}, {3.711328009489965*^9, 3.7113280146895723`*^9}, {
   3.711328365716524*^9, 3.711328369941804*^9}, 3.711328588857829*^9, {
   3.711330088576027*^9, 
   3.7113300955254393`*^9}},ExpressionUUID->"d1ecf4e6-9311-46e0-b8ed-\
43196b4fcf77"]
}, Closed]],

Cell[CellGroupData[{

Cell["NVCenterEnergySpectrum[\[ScriptCapitalH], spins] ", "Subsubsection",
 CellChangeTimes->{{3.7113260883845882`*^9, 3.711326111809495*^9}, {
   3.711332555470126*^9, 3.711332568164446*^9}, 3.711334848327389*^9, {
   3.7113350005280647`*^9, 3.71133500187857*^9}, {3.711339053376975*^9, 
   3.711339055102112*^9}, {3.7113401482578506`*^9, 3.7113401564579973`*^9}, 
   3.711682369107785*^9},ExpressionUUID->"1b8b7d2e-2be2-4995-a67c-\
22798fcb400e"],

Cell["s", "Text",
 CellChangeTimes->{
  3.711330477902047*^9},ExpressionUUID->"a71c1a2f-e2f1-4e8b-8b36-\
9bead87b72ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NVCenterEnergySpectrum", "[", 
    RowBox[{"\[ScriptCapitalH]_", ",", " ", "spins_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"basis", ",", " ", 
       RowBox[{"mult", " ", "=", " ", 
        RowBox[{
         RowBox[{"2", "spins"}], " ", "+", " ", "1"}]}], ",", " ", "eig", ",",
        " ", "energies", ",", " ", "states", ",", "vecDecomps", " ", ",", " ",
        "vecsIndices", ",", " ", "vecs", ",", " ", "strs", ",", 
       "\[IndentingNewLine]", "coeff", ",", " ", "label", ",", "Jz", ",", " ",
        "angMoms", ",", " ", "table", ",", " ", "data"}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"basis", "[", "indices_", "]"}], ":=", " ", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"KroneckerProduct", ",", " ", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"IdentityMatrix", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"mult", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "]"}], ",",
               " ", 
              RowBox[{
               RowBox[{"indices", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "  ", "-", " ", "1"}]}], 
             "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "[", "spins", "]"}]}], "}"}]}], "]"}]}], 
         "]"}], " ", "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"eig", " ", "=", " ", 
       RowBox[{"Eigensystem", "[", "\[ScriptCapitalH]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energies", " ", "=", " ", 
       RowBox[{"eig", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"states", " ", "=", " ", 
       RowBox[{"eig", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vecDecomps", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vecsIndices", " ", "=", " ", 
          RowBox[{"Tuples", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"Range", ",", " ", "mult"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vecs", " ", "=", " ", 
          RowBox[{"Map", "[", " ", 
           RowBox[{"basis", ",", " ", "vecsIndices"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"strs", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"coeff", " ", "=", " ", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"vecs", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", ".", " ", 
              RowBox[{"states", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"label", " ", "=", " ", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"\"\<|\>\"", "<>", 
                RowBox[{"StringRiffle", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"spins", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"vecsIndices", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", "+", " ", "1"}], 
                    ")"}], "//", "Rationalize"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", " ", "1", ",", " ", 
                    RowBox[{"Length", "[", "spins", "]"}]}], "}"}]}], "]"}], 
                  ",", "\"\<,\>\""}], "]"}], "<>", 
                "\"\<\[RightAngleBracket]\>\""}], ",", " ", "Bold"}], "]"}]}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"coeff", " ", "\[NotEqual]", " ", "0"}], ",", " ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"strs", ",", 
                RowBox[{"coeff", " ", "*", " ", "label"}]}], "]"}]}], "]"}], 
            ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "vecsIndices", "]"}]}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"vecDecomps", ",", " ", "strs"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Jz", " ", "=", " ", 
       RowBox[{
        RowBox[{"FullHilbertSpaceOperator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", " ", "\[Rule]", " ", 
            RowBox[{"SpinMatrixZ", "[", 
             RowBox[{"spins", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}], "  ", ",", 
          " ", "mult"}], "]"}], " ", "+", "\[IndentingNewLine]", 
        RowBox[{"FullHilbertSpaceOperator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", " ", "\[Rule]", " ", 
            RowBox[{"SpinMatrixZ", "[", 
             RowBox[{"spins", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "]"}]}], "}"}], "  ", ",", 
          "mult"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"angMoms", " ", "=", " ", 
       RowBox[{"Map", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", " ", ".", " ", "Jz", " ", ".", " ", "#"}], " ", "&"}], 
         ",", " ", "states"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"data", " ", "=", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "energies", ",", "\[IndentingNewLine]", "vecDecomps", ",", 
         "\[IndentingNewLine]", "angMoms"}], "\[IndentingNewLine]", "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"table", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"energies", ",", " ", "\"\<---\>\""}], "]"}], ",", " ", 
             
             RowBox[{"Style", "[", 
              RowBox[{"\"\<E\>\"", ",", " ", "Bold"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Prepend", "[", " ", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"vecDecomps", ",", " ", "\"\<---\>\""}], "]"}], ",", 
             " ", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<|\!\(\*SubscriptBox[\(\[Psi]\), \(E\)]\)\
\[RightAngleBracket]\>\"", ",", " ", "Bold"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"angMoms", ",", " ", "\"\<---\>\""}], "]"}], ",", "  ", 
             
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\[LeftAngleBracket]\!\(\*SubscriptBox[\(J\), \(z\)]\)\
\[RightAngleBracket]\>\"", ",", " ", "Bold"}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], " ", "//", " ", "Transpose"}], " ", "//",
         "MatrixForm"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"data", ",", " ", "table"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71133674453998*^9, 3.7113368788152647`*^9}, 
   3.711337271794281*^9, {3.711337464018773*^9, 3.711337549294038*^9}, {
   3.7113379046501617`*^9, 3.711338298174623*^9}, {3.711338481352322*^9, 
   3.711338481625621*^9}, {3.7113385125012407`*^9, 3.711338545677997*^9}, {
   3.7113385936548853`*^9, 3.711338608967759*^9}, {3.711338821552692*^9, 
   3.7113388259529877`*^9}, {3.711338856179758*^9, 3.711338962203877*^9}, {
   3.711339720284308*^9, 
   3.71133972877943*^9}},ExpressionUUID->"6706f073-dc9c-4504-bd25-\
78b5208faf1e"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetSybsystemA[density, subSystemSize]", "Subsubsection",
 CellChangeTimes->{{3.711341391789639*^9, 
  3.711341398765058*^9}},ExpressionUUID->"e391d773-8db5-4b46-a4a5-\
474af753f2a4"],

Cell[TextData[{
 "For a density matrix \[Rho] in the space ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["A", "1"], " ", "\[TensorProduct]", " ", 
      SubscriptBox["A", "2"], " ", "\[TensorProduct]"}], " ", "..."}], " ", 
    "\[TensorProduct]", " ", 
    SubscriptBox["A", "n"]}], TraditionalForm]],ExpressionUUID->
  "d460020e-819d-4dc2-994d-e30b23b5096e"],
 ", the function will return the reduced density matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", 
    SubscriptBox["A", "1"]], TraditionalForm]],ExpressionUUID->
  "880780a3-648d-4564-a0f0-b7d588da0bcb"],
 "."
}], "Text",
 CellChangeTimes->{{3.711341401615139*^9, 
  3.711341408990777*^9}},ExpressionUUID->"c5d67a90-77e2-4dc2-923b-\
30b4510f0e28"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetSubsystemA", "[", 
    RowBox[{"density_", ",", " ", "subSystemSize_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Map", "[", " ", 
    RowBox[{"Tr", ",", " ", 
     RowBox[{"Partition", "[", " ", 
      RowBox[{"density", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "density", "]"}], "/", "subSystemSize"}], 
         ",", " ", 
         RowBox[{
          RowBox[{"Length", "[", "density", "]"}], "/", "subSystemSize"}]}], 
        "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71134140321796*^9, 
  3.711341405053318*^9}},ExpressionUUID->"e6f3ee31-b05f-43a9-b331-\
75dff12fa8e0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
RunSimulation[freqStart,  freqEnd, freqStep, \[ScriptCapitalH],  spins,  \
spinVec,  density0]\
\>", "Subsubsection",
 CellChangeTimes->{{3.711340079007985*^9, 3.7113400817822847`*^9}, {
  3.711340673138195*^9, 3.7113406854858313`*^9}, {3.711340759536162*^9, 
  3.711340761511353*^9}},ExpressionUUID->"7e684e91-45bf-4108-aa9b-\
43dd3b243eef"],

Cell["sd", "Text",
 CellChangeTimes->{{3.711340084257413*^9, 
  3.711340086007327*^9}},ExpressionUUID->"78e0107b-2ec0-4b9b-a8ce-\
5fa2857f329e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RunSimulation", "[", 
     RowBox[{
     "freqStart_", ",", " ", "freqEnd_", ",", " ", "freqStep_", ",", " ", 
      "tStart_", ",", " ", "tEnd_", ",", " ", "\[ScriptCapitalH]_", ",", " ", 
      "spins_", ",", " ", "spinVec_", ",", " ", "density0_"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "calculations", ",", "systemSize", ",", " ", "density", ",", " ", 
        "eqnTotal", ",", " ", "eqns", ",", " ", "diffeqs", ",", " ", "funcs", 
        ",", " ", "initialStateEqs", ",", " ", "params", ",", 
        "\[IndentingNewLine]", "data", ",", " ", "tic", ",", " ", "count", 
        ",", " ", "sol", ",", " ", "pulseFreq", ",", " ", "pFunc", ",", " ", 
        "p", ",", " ", "prw", ",", " ", "toc", ",", " ", "ttot"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"calculations", " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"f", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "f", ",", " ", "freqStart", ",", " ", "freqEnd", ",", " ", 
             "freqStep"}], "}"}]}], "]"}], " ", "//", " ", "Length"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Setup", " ", "Density", " ", "matrix"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"systemSize", " ", "=", " ", 
        RowBox[{"Apply", "[", 
         RowBox[{"Times", ",", " ", 
          RowBox[{
           RowBox[{"2", "spins"}], "+", "1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"density", " ", "=", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "[", 
            RowBox[{"i", ",", " ", "j"}], "]"}], "[", "t", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "1", ",", " ", "systemSize"}], "}"}]}], 
         "]"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"density", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"density", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", 
           RowBox[{"i", "+", "1"}], ",", " ", "systemSize"}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Define", " ", "master", " ", "equation"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"eqnTotal", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"\[ImaginaryI]", "  ", 
           RowBox[{"D", "[", " ", 
            RowBox[{"density", ",", " ", "t"}], "]"}]}], " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[ScriptCapitalH]", "[", 
              RowBox[{"f", ",", " ", "t"}], "]"}], ".", "density"}], " ", "-",
             " ", 
            RowBox[{"density", ".", 
             RowBox[{"\[ScriptCapitalH]", "[", 
              RowBox[{"f", ",", " ", "t"}], "]"}]}]}], ")"}]}], " ", "//", 
         " ", "Simplify"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eqns", " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"eqnTotal", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "i", ",", " ", "systemSize"}], "}"}]}], 
          "]"}], " ", "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"diffeqs", " ", "=", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"eqns", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "eqns", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"funcs", " ", "=", 
        RowBox[{
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"density", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "i", ",", " ", "systemSize"}], "}"}]}], 
          "]"}], " ", "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialStateEqs", " ", "=", "  ", 
        RowBox[{
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "[", 
              RowBox[{"i", ",", " ", "j"}], "]"}], "[", "0", "]"}], " ", 
            "\[Equal]", " ", 
            RowBox[{"density0", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", "systemSize"}], "}"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "i", ",", " ", "systemSize"}], "}"}]}], 
          "]"}], "  ", "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"params", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"diffeqs", ",", " ", "initialStateEqs"}], " ", "}"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Perform", " ", "simulation"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"data", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Store", " ", "spinVec", " ", "probability", " ", "data", " ", "for", 
         " ", "each", " ", "frequency"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"tic", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"count", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"plot", " ", "=", 
        RowBox[{"Dynamic", "[", 
         RowBox[{
          RowBox[{"ListPlot", "[", "data", "]"}], ",", " ", 
          RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
           RowBox[{"{", "data", "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "plot", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"sol", " ", "=", " ", 
           RowBox[{"NDSolve", "[", " ", 
            RowBox[{
             RowBox[{"params", " ", "/.", " ", 
              RowBox[{"f", " ", "\[Rule]", " ", "freq"}]}], ",", " ", "funcs",
              ",", " ", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "tStart", ",", " ", "tEnd"}], "}"}], ",",
              " ", "\[IndentingNewLine]", 
             RowBox[{"PrecisionGoal", "\[Rule]", "7"}], ",", 
             RowBox[{"AccuracyGoal", "\[Rule]", "7"}], ",", " ", 
             RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Take", " ", "electron", " ", "triplet", " ", "sybsystem", " ", 
            "of", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"pFunc", " ", "=", " ", 
           RowBox[{
            RowBox[{"Conjugate", "[", "spinVec", "]"}], " ", ".", " ", 
            RowBox[{"GetSubsystemA", "[", 
             RowBox[{"density", ",", " ", 
              RowBox[{"systemSize", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"spins", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", "2"}], " ", "+", " ", 
                 "1"}], ")"}]}]}], "]"}], " ", ".", " ", "spinVec"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p", " ", "=", " ", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"tEnd", " ", "-", " ", "tStart"}]], 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{"pFunc", " ", "/.", " ", "sol"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"t", ",", " ", "tStart", ",", " ", "tEnd"}], "}"}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"data", ",", " ", 
            RowBox[{"{", 
             RowBox[{"freq", ",", " ", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"NotebookDelete", "[", "prw", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"prw", " ", "=", " ", 
           RowBox[{"PrintTemporary", "[", 
            RowBox[{
            "\"\<Calculation \>\"", ",", " ", "count", ",", " ", 
             "\"\< out of \>\"", ",", " ", "calculations"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"count", " ", "=", " ", 
           RowBox[{"count", " ", "+", " ", "1"}]}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "freq", ",", " ", "freqStart", ",", " ", "freqEnd", ",", " ", 
           "freqStep"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"toc", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ttot", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"toc", "-", "tic"}], ")"}], "/", "60"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Total time taken (min) = \>\"", ",", "ttot"}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"data", ",", " ", "ttot"}], "}"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.7113400871599007`*^9, 3.711340120782799*^9}, {
   3.7113401610330687`*^9, 3.7113404343114634`*^9}, {3.711340489889118*^9, 
   3.7113405383623257`*^9}, {3.7113407424903183`*^9, 3.711340757388845*^9}, {
   3.711340849090423*^9, 3.711340890014525*^9}, 3.711340986242293*^9, {
   3.711341227417221*^9, 3.7113412281663637`*^9}, {3.711341274641878*^9, 
   3.711341297091722*^9}, {3.7113413367205772`*^9, 3.711341338242292*^9}, {
   3.711341441595036*^9, 3.7113415553194513`*^9}, {3.711341679520356*^9, 
   3.711341706969592*^9}, {3.7113424518772573`*^9, 3.711342501998398*^9}, {
   3.711342572305153*^9, 3.7113426208519278`*^9}, {3.7113426792273684`*^9, 
   3.711342682090027*^9}, 3.71134417666389*^9, {3.711347476204954*^9, 
   3.7113475016298656`*^9}, 3.7113475610131397`*^9, 3.711347599657731*^9, 
   3.711347658206139*^9, {3.711347689972602*^9, 3.711347703354424*^9}, {
   3.711347738896242*^9, 3.711347739005151*^9}, {3.711347804644693*^9, 
   3.711347804828*^9}, {3.711347845604918*^9, 3.7113478515296288`*^9}, {
   3.7113479234412203`*^9, 3.711347924902978*^9}, {3.711347965595332*^9, 
   3.711347968632806*^9}, {3.711348189781046*^9, 3.711348207281797*^9}, {
   3.711348722838646*^9, 3.711348726286742*^9}, {3.711348952387973*^9, 
   3.711348982161728*^9}, {3.711349401567112*^9, 3.7113494018129473`*^9}, 
   3.7113505435622187`*^9, {3.711352481608082*^9, 3.711352484958165*^9}, 
   3.711352531516582*^9, {3.7113742254650106`*^9, 3.711374225862051*^9}, {
   3.7114245563247843`*^9, 3.7114245645242233`*^9}, {3.711424632353903*^9, 
   3.711424635100154*^9}, 3.711424699225112*^9, {3.711424772303143*^9, 
   3.711424772651308*^9}, {3.711424846800071*^9, 3.711424860375486*^9}, {
   3.711426041456724*^9, 3.71142604443211*^9}, 3.7116787730961933`*^9, {
   3.711682264158435*^9, 
   3.711682267233618*^9}},ExpressionUUID->"1b0f4fbd-7283-4357-9fc4-\
5f9f4122e081"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["No spin-bath", "Title",
 CellChangeTimes->{{3.711246437497582*^9, 3.7112464454897118`*^9}, {
  3.711339541404573*^9, 
  3.711339542979619*^9}},ExpressionUUID->"86ac2eed-bad9-42f2-9914-\
4d2eb50a153a"],

Cell[CellGroupData[{

Cell["Initialisation", "Subsection",
 CellChangeTimes->{{3.711326135259593*^9, 
  3.711326137384762*^9}},ExpressionUUID->"9230f74c-3079-4432-a627-\
3706e53bbdd3"],

Cell[CellGroupData[{

Cell["Simulation parameters", "Subsubsection",
 CellChangeTimes->{{3.711327321484583*^9, 
  3.711327325359797*^9}},ExpressionUUID->"5cefe403-c097-4393-9bdc-\
52d4991e7e46"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pulseAmplitude", " ", "=", " ", 
    RowBox[{"7", "*", 
     SuperscriptBox["10", "6"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pulsePhase", " ", "=", " ", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pulseFreqStart", " ", "=", " ", 
    RowBox[{"2.575", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pulseFreqEnd", " ", "=", " ", 
    RowBox[{"3.175", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pulseFreqStep", " ", "=", " ", 
    RowBox[{"0.1", "*", 
     SuperscriptBox["10", "6"]}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"[", "Hz", "]"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{"calculations", " ", "=", " ", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "f", ",", " ", "pulseFreqStart", ",", " ", "pulseFreqEnd", ",", " ", 
         "pulseFreqStep"}], "}"}]}], "]"}], " ", "//", " ", "Length"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tStart", " ", "=", " ", "0"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Start", "-", 
    RowBox[{"time", " ", "of", " ", 
     RowBox[{"NDSolve", " ", "[", "s", "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"tEnd", " ", "=", " ", 
   RowBox[{"2", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"End", "-", 
    RowBox[{"time", " ", "of", " ", 
     RowBox[{"NDSolve", " ", "[", "s", "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"B0", " ", "=", 
   RowBox[{"0", "*", "513", " ", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"DC", " ", "Applied", " ", 
    RowBox[{"field", " ", "[", "T", "]"}]}], " ", "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]s", "=", " ", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "\[Gamma]e"}], " ", "B0"}], 
    RowBox[{"2", "\[Pi]"}]]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Omega]I", "=", 
   FractionBox[
    RowBox[{"\[Gamma]N", " ", "B0"}], 
    RowBox[{"2", "\[Pi]"}]]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of calculations: \>\"", ",", " ", "calculations"}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.711327327435595*^9, 3.711327496377437*^9}, {
   3.711327550311452*^9, 3.7113275505627604`*^9}, {3.711341568946257*^9, 
   3.711341614216663*^9}, {3.711374279182678*^9, 3.7113742802612047`*^9}, {
   3.711424925850017*^9, 3.711424929974256*^9}, {3.711425010750031*^9, 
   3.711425012024644*^9}, {3.7114259776822367`*^9, 3.711425994533032*^9}, 
   3.7116785463043528`*^9, {3.711681843181076*^9, 3.711681843885611*^9}, {
   3.71168187960602*^9, 
   3.711681956730383*^9}},ExpressionUUID->"a40b7a0c-be1c-4915-96c3-\
03848366f46e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of calculations: \"\>", "\[InvisibleSpace]", "6001"}],
  SequenceForm["Number of calculations: ", 6001],
  Editable->False]], "Print",
 CellChangeTimes->{{3.711341608516604*^9, 3.711341614488844*^9}, {
   3.711341718712531*^9, 3.711341727241106*^9}, 3.711341791127582*^9, 
   3.711341836797695*^9, 3.711348195983433*^9, {3.7113742708914337`*^9, 
   3.7113742903257923`*^9}, 3.711424939890831*^9, 3.711425016143168*^9, {
   3.711425991586309*^9, 3.711425995220482*^9}, 3.711426052188053*^9, {
   3.7116785520322933`*^9, 3.7116785554721823`*^9}, 3.711679157880118*^9, 
   3.711680142428087*^9, {3.71168195222445*^9, 3.711681957103387*^9}, 
   3.711682311206623*^9, 
   3.7116824848613577`*^9},ExpressionUUID->"b293937c-0eba-44fe-a718-\
aa2433693ab6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup Hamiltonian", "Subsubsection",
 CellChangeTimes->{{3.711326144009676*^9, 
  3.7113261459847507`*^9}},ExpressionUUID->"da94ca88-ba88-458b-925e-\
d216f9f64e04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"spins", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "1"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]HF", " ", "=", " ", 
    RowBox[{"2", "\[Pi]", " ", "*", " ", 
     RowBox[{"SpinSpinHamiltonian", "[", "\[IndentingNewLine]", 
      RowBox[{"spins", ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", " ", "\[Rule]", " ", "2"}], ",", " ", "Ahf"}], "}"}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]spinSpin", " ", "=", " ", 
    RowBox[{"2", "\[Pi]", " ", "*", "  ", 
     RowBox[{"SpinSpinHamiltonian", "[", "\[IndentingNewLine]", 
      RowBox[{"spins", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", " ", "\[Rule]", " ", "1"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", "Dzfs"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", " ", "\[Rule]", " ", "2"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", " ", "Pzfs"}], "}"}]}], "}"}]}], 
        "}"}]}], "\[IndentingNewLine]", "]"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]zee", " ", "=", " ", 
    RowBox[{"2", "\[Pi]", " ", "*", "  ", 
     RowBox[{"ZeemanHamiltonian", "[", 
      RowBox[{"spins", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Omega]s", ",", " ", "\[Omega]I", ",", " ", "0"}], "}"}]}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]NV", " ", "=", " ", 
    RowBox[{
    "\[ScriptCapitalH]HF", " ", "+", " ", "\[ScriptCapitalH]spinSpin", " ", 
     "+", " ", "\[ScriptCapitalH]zee"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalH]Cop", " ", "=", " ", 
   RowBox[{"2", "\[Pi]", " ", "*", "  ", "pulseAmplitude", "*", " ", 
    RowBox[{"FullHilbertSpaceOperator", "[", " ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"1", "\[Rule]", " ", 
         RowBox[{"SpinMatrixX", "[", "1", "]"}]}], ",", " ", 
        RowBox[{"2", "\[Rule]", " ", 
         RowBox[{"SpinMatrixX", "[", "1", "]"}]}]}], " ", "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"3", ",", " ", "3"}], "}"}]}], " ", "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[ScriptCapitalH]C", "[", 
     RowBox[{"f_", ",", " ", "t_"}], "]"}], " ", ":=", 
    RowBox[{"\[ScriptCapitalH]Cop", " ", "*", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"2", "\[Pi]", " ", "f", " ", "t"}], " ", "+", " ", 
       "pulsePhase"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]", "[", 
    RowBox[{"f_", ",", "t_"}], "]"}], " ", ":=", " ", 
   RowBox[{"\[ScriptCapitalH]NV", "  ", "+", " ", 
    RowBox[{"\[ScriptCapitalH]C", "[", 
     RowBox[{"f", ",", "t"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7113266610971823`*^9, 3.7113266983812313`*^9}, {
  3.711326759656721*^9, 3.711326807406846*^9}, {3.71132688780748*^9, 
  3.711326900757473*^9}, {3.711327169610208*^9, 3.711327317259818*^9}, {
  3.711328562691675*^9, 3.711328639167479*^9}, {3.711328690593836*^9, 
  3.711328716767874*^9}, {3.711328793069077*^9, 3.7113288195683937`*^9}, {
  3.711330155551496*^9, 3.7113302703264923`*^9}, {3.711330811180303*^9, 
  3.7113308608554068`*^9}, {3.711330965706061*^9, 3.711330965956944*^9}, {
  3.711331118207323*^9, 3.7113311259314938`*^9}, {3.711332393264576*^9, 
  3.711332402338951*^9}, {3.711335655309301*^9, 3.711335656407692*^9}, {
  3.7113399374353848`*^9, 3.711339972507593*^9}, {3.71134046281201*^9, 
  3.7113404768606033`*^9}, {3.7113481248558693`*^9, 3.711348176730978*^9}, {
  3.711348290582694*^9, 3.711348309105291*^9}, {3.7116780889649878`*^9, 
  3.711678118640745*^9}},ExpressionUUID->"db128fd9-f2ef-4e2b-8cb1-\
82a1b52e073e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial state", "Subsubsection",
 CellChangeTimes->{{3.7113405719102716`*^9, 
  3.71134057401019*^9}},ExpressionUUID->"27086003-bba5-40f5-9ddd-\
a9a3b6912713"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eig", " ", "=", " ", 
   RowBox[{"Eigensystem", "[", "\[ScriptCapitalH]NV", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groundState", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"eig", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"eig", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"eig", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "}"}], " ", "//", " ", 
    "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"density0", " ", "=", " ", 
   RowBox[{"groundState", " ", ".", " ", 
    RowBox[{"ConjugateTranspose", "[", "groundState", "]"}]}]}], " ", 
  ";"}]}], "Input",
 CellChangeTimes->{{3.711340575038134*^9, 
  3.711340602985878*^9}},ExpressionUUID->"99185e00-5b28-41b1-902a-\
42d8fef6e39e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Meta", "Subsubsection",
 CellChangeTimes->{{3.7113304067517138`*^9, 
  3.711330407126807*^9}},ExpressionUUID->"fe58d293-8aa8-40f4-ac76-\
1e5d82fb5a0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fileNamePrefix", " ", "=", " ", 
   RowBox[{"\"\<results/nv_center_simulation\>\"", "  ", "<>", " ", 
    RowBox[{"StringReplace", "[", " ", 
     RowBox[{
      RowBox[{"DateString", "[", "\"\<ISODateTime\>\"", "]"}], ",", " ", 
      RowBox[{"\"\<:\>\"", " ", "\[Rule]", " ", "\"\<.\>\""}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comments", " ", "=", " ", 
   RowBox[{"StringRiffle", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Pulse that acts on both nuclear spin and electron spin\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<B0=``T\>\"", ",", "B0"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<Frequency Resolution=``Hz\>\"", ",", " ", "pulseFreqStep"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<Pulse amplitude=``Hz\>\"", ",", " ", "pulseAmplitude"}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], ",", " ", "\"\<. \>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7113304083285027`*^9, 3.711330448428396*^9}, 
   3.711340006107974*^9},ExpressionUUID->"1ed51bf3-7eb6-43fc-9035-\
bf613a6ef044"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run simulation", "Subsection",
 CellChangeTimes->{{3.7113406549606533`*^9, 
  3.711340658260653*^9}},ExpressionUUID->"400df2bd-2225-447a-820d-\
ca2f16c7d59e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"spinVec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{"RunSimulation", "[", 
    RowBox[{
    "pulseFreqStart", ",", "pulseFreqEnd", ",", " ", "pulseFreqStep", ",", 
     " ", "tStart", ",", " ", "tEnd", ",", " ", "\[ScriptCapitalH]", ",", 
     "spins", ",", "spinVec", ",", "density0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"res", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalSimulationTime", " ", "=", " ", 
   RowBox[{"res", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.711340659287634*^9, 3.7113406616108027`*^9}, 
   3.7113409593149033`*^9, {3.711341636991076*^9, 3.711341640040976*^9}, {
   3.711341732441669*^9, 3.71134173686668*^9}, {3.7113417999192677`*^9, 
   3.711341827117606*^9}, {3.711424676672743*^9, 3.711424678598373*^9}, {
   3.711682274707357*^9, 
   3.711682288731346*^9}},ExpressionUUID->"2ba5b246-1012-4bd5-854b-\
812609a1f26b"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ListPlot[$CellContext`data$19053], StandardForm],
  ImageSizeCache->{645., {195., 197.}},
  TrackedSymbols:>{$CellContext`data$19053}]], "Print",
 CellChangeTimes->{3.711679161482573*^9, 3.711682313200872*^9, 
  3.711682486540461*^9},ExpressionUUID->"bb6bdfea-d9ab-40da-b3c0-\
2e448eed746d"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","slwcon",
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"",2,267,32,27567918183901105779,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711679216859386*^9, 3.7116823366470222`*^9, 
  3.711682512496155*^9},ExpressionUUID->"9c5e872e-4940-4f41-92df-\
69c4cb4455fc"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"t\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"1.5621891671893522`*^-7\\\", \
\\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"1.9999033662862055`*^-6\\\", \\\"-\\\", \
RowBox[{\\\"2.8211442314478326`*^-25\\\", \\\" \\\", \
\\\"\[ImaginaryI]\\\"}]}]\\) and \
\\!\\(\\*RowBox[{\\\"3.78361260436844`*^-12\\\"}]\\) for the integral and \
error estimates.\"",2,267,33,27567918183901105779,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711679216859386*^9, 3.7116823366470222`*^9, 
  3.711682512811696*^9},ExpressionUUID->"cb992721-b67d-4966-bbc2-\
741ee759c246"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","slwcon",
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"",2,267,34,27567918183901105779,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711679216859386*^9, 3.7116823366470222`*^9, 
  3.711682538261147*^9},ExpressionUUID->"ba88c472-db4c-47a5-967d-\
116f19a1776d"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"t\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"5.429376667189352`*^-7\\\", \
\\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"1.999942777387422`*^-6\\\", \\\"+\\\", \
RowBox[{\\\"9.839268622880205`*^-26\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\
\\) and \\!\\(\\*RowBox[{\\\"3.711467893464755`*^-12\\\"}]\\) for the \
integral and error estimates.\"",2,267,35,27567918183901105779,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711679216859386*^9, 3.7116823366470222`*^9, 
  3.711682538547011*^9},ExpressionUUID->"eba047d1-7e9c-466f-b6b1-\
e144be7536b9"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","slwcon",
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"",2,267,36,27567918183901105779,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711679216859386*^9, 3.7116823366470222`*^9, 
  3.7116825629954853`*^9},ExpressionUUID->"043d4002-0cb6-4c20-b14a-\
a6ee3709a8f8"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"slwcon\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,267,37,27567918183901105779,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711679216859386*^9, 3.7116823366470222`*^9, 
  3.7116825631352797`*^9},ExpressionUUID->"27c548e1-2fbd-4c62-861b-\
cce547ffb0ba"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"t\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"1.5621891671893522`*^-7\\\", \
\\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"1.9999449748616654`*^-6\\\", \\\"-\\\", \
RowBox[{\\\"6.305862078939073`*^-27\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\
\\) and \\!\\(\\*RowBox[{\\\"3.789614576263772`*^-12\\\"}]\\) for the \
integral and error estimates.\"",2,267,38,27567918183901105779,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711679216859386*^9, 3.7116823366470222`*^9, 
  3.7116825634254837`*^9},ExpressionUUID->"7f9bbe16-dea3-4c29-9e42-\
21724692830d"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"ncvb\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"",2,267,39,27567918183901105779,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.711679216859386*^9, 3.7116823366470222`*^9, 
  3.711682563566444*^9},ExpressionUUID->"fbf3faf6-14c4-424c-9dce-\
5642e138f323"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Calculation \"\>", "\[InvisibleSpace]", "44", 
   "\[InvisibleSpace]", "\<\" out of \"\>", "\[InvisibleSpace]", "6001"}],
  SequenceForm["Calculation ", 44, " out of ", 6001],
  Editable->False]], "PrintTemporary",
 CellChangeTimes->{
  3.711683574931542*^9},ExpressionUUID->"b5a76549-92fe-45a3-8a7d-\
f65953ea9e5f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results", "Subsection",
 CellChangeTimes->{{3.7113349490780897`*^9, 
  3.711334949853162*^9}},ExpressionUUID->"8214d20f-0e1b-43da-836e-\
a05559a345ef"],

Cell[CellGroupData[{

Cell["Energy spectrum of the unperturbed Hamiltonian", "Subsubsection",
 CellChangeTimes->{{3.711334963953167*^9, 
  3.7113349865784607`*^9}},ExpressionUUID->"429b76d5-4d40-431e-966a-\
b04ef682fe2a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hamiltonianSpectrum", " ", "=", " ", 
  RowBox[{
   RowBox[{"NVCenterEnergySpectrum", "[", 
    RowBox[{"\[ScriptCapitalH]NV", ",", " ", "spins"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.711334974728861*^9, 3.711335007730961*^9, {3.71168237495683*^9, 
   3.711682426483138*^9}, {3.711682456908224*^9, 
   3.711682471506604*^9}},ExpressionUUID->"a8890a55-1f87-449b-b31d-\
a5ea7393b3d4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["\<\"E\"\>",
       StripOnInput->False,
       FontWeight->Bold], 
      StyleBox["\<\"|\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(E\\)]\\)\
\[RightAngleBracket]\"\>",
       StripOnInput->False,
       FontWeight->Bold], 
      StyleBox["\<\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(J\\), \
\\(z\\)]\\)\[RightAngleBracket]\"\>",
       StripOnInput->False,
       FontWeight->Bold]},
     {"\<\"---\"\>", "\<\"---\"\>", "\<\"---\"\>"},
     {"1.8032751469627785`*^10", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.0007304469014447893`"}], " ", 
         StyleBox["\<\"|0,-1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999997332236265`", " ", 
         StyleBox["\<\"|-1,0\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "0.9999999999999999`"}]},
     {"1.8032751469627785`*^10", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.9999997332236265`", " ", 
         StyleBox["\<\"|1,0\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0007304469014447897`"}], " ", 
         StyleBox["\<\"|0,1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "0.9999999999999999`"},
     {"1.801523107266816`*^10", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.7071064018686761`", " ", 
         StyleBox["\<\"|1,-1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0010357956695105914`"}], " ", 
         StyleBox["\<\"|0,0\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.7071064018686757`", " ", 
         StyleBox["\<\"|-1,1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "0.`"},
     {"1.801521174459838`*^10", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.7071067811865471`"}], " ", 
         StyleBox["\<\"|1,-1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"5.84880656760434`*^-19", " ", 
         StyleBox["\<\"|0,0\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.7071067811865478`", " ", 
         StyleBox["\<\"|-1,1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "0.`"},
     {"1.7988068384071365`*^10", 
      RowBox[{"{", 
       RowBox[{"1.`", " ", 
        StyleBox["\<\"|1,1\[RightAngleBracket]\"\>",
         StripOnInput->False,
         FontWeight->Bold]}], "}"}], "2.`"},
     {"1.7988068384071365`*^10", 
      RowBox[{"{", 
       RowBox[{"1.`", " ", 
        StyleBox["\<\"|-1,-1\[RightAngleBracket]\"\>",
         StripOnInput->False,
         FontWeight->Bold]}], "}"}], 
      RowBox[{"-", "2.`"}]},
     {
      RowBox[{"-", "3.1111405292907715`*^7"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.9999997332236265`", " ", 
         StyleBox["\<\"|0,-1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007304469014447894`", " ", 
         StyleBox["\<\"|-1,0\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "0.9999999999999999`"}]},
     {
      RowBox[{"-", "3.111140529289627`*^7"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.0007304469014447897`", " ", 
         StyleBox["\<\"|1,0\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999997332236265`", " ", 
         StyleBox["\<\"|0,1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "0.9999999999999999`"},
     {
      RowBox[{"-", "19328.06977081299`"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.0007324181418346003`", " ", 
         StyleBox["\<\"|1,-1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999994635635217`", " ", 
         StyleBox["\<\"|0,0\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007324181418345988`", " ", 
         StyleBox["\<\"|-1,1\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7116823874482183`*^9, 3.711682427338159*^9, 
  3.711682469279661*^9},ExpressionUUID->"cd260d02-e79d-4dee-b601-\
e54cb8024258"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation results", "Subsubsection",
 CellChangeTimes->{{3.711340636335628*^9, 
  3.711340639461668*^9}},ExpressionUUID->"6ee10d68-549c-4163-8cec-\
7e3d2c17f02d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plot", " ", "=", " ", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"data", ",", " ", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{"comments", ",", " ", "12"}], "]"}]}], ",", " ", 
    RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
     RowBox[{"{", " ", 
      RowBox[{"\"\<Pulse frequency [Hz]\>\"", ",", " ", "\"\<Prob(T_0)\>\""}],
       "}"}]}], ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.7", ",", " ", "1"}], "}"}]}], ",", " ", 
    RowBox[{"ImageSize", " ", "\[Rule]", " ", "Large"}]}], " ", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.711680039026285*^9, 3.711680041945615*^9}, {
  3.7116821129051523`*^9, 
  3.71168214454282*^9}},ExpressionUUID->"0df7c1e8-b417-43ad-8746-\
bd500ceaf0a8"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{2.867*^9, 0.8860020329013006}, {2.868*^9, 
      0.8674305130315194}, {2.869*^9, 0.8503013714776716}, {2.87*^9, 
      0.8296394115567108}, {2.871*^9, 0.8072515867069981}, {2.872*^9, 
      0.7868592870360173}, {2.873*^9, 0.7663619183090162}, {2.874*^9, 
      0.7562077579604337}, {2.875*^9, 0.7500087837588182}, {2.876*^9, 
      0.756501627836609}, {2.877*^9, 0.7659555227469126}, {2.878*^9, 
      0.7868295348531225}, {2.879*^9, 0.8077011989997032}, {2.88*^9, 
      0.829487508463966}, {2.881*^9, 
      0.8487755702782088}}]}, {}}, {}, {}, {{}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"Pulse frequency [Hz]\"", TraditionalForm], 
    FormBox["\"Prob(T_0)\"", TraditionalForm]},
  AxesOrigin->{2.86678125*^9, 0.7014999999999999},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox[
    "\"Pulse that acts on both nuclear spin and electron spin. B0=0T. \
Frequency Resolution=1000000Hz. Pulse amplitude=7000000Hz\"", 12, 
     StripOnInput -> False], TraditionalForm],
  PlotRange->{{2.867*^9, 2.881*^9}, {0.7, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.711680042287381*^9, {3.7116821145182877`*^9, 3.711682144886033*^9}, 
   3.711682206972371*^9},ExpressionUUID->"0a410159-5932-4e64-9b80-\
cd4f8255dd7e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Save simulation data", "Subsubsection",
 CellChangeTimes->{{3.711158126880466*^9, 
  3.711158130555336*^9}},ExpressionUUID->"cbf8282b-f8a2-48ff-b963-\
e2f233ebfe31"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"fileNamePrefix", "<>", " ", "\"\<_data.csv\>\""}], ",", " ", 
    "data"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"fileNamePrefix", "<>", " ", "\"\<_spectrum.csv\>\""}], ",", " ", 
    "hamiltonianSpectrum"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"fileNamePrefix", "<>", " ", "\"\<_plot.pdf\>\""}], ",", " ", 
    "plot"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Save", "[", " ", 
   RowBox[{
    RowBox[{"fileNamePrefix", " ", "<>", " ", "\"\<_params.dat\>\""}], ",", 
    " ", 
    RowBox[{"{", "  ", 
     RowBox[{
     "comments", ",", " ", "totalSimulationTime", ",", " ", "pulseAmplitude", 
      ",", "pulsePhase", ",", "pulseFreqStart", ",", "pulseFreqEnd", ",", 
      "calculations", ",", "pulseFreqStep", ",", "\[Gamma]N", ",", 
      "\[Gamma]e", ",", "B0", ",", "\[Omega]s", ",", "\[Omega]I", ",", "Ahf", 
      ",", "Dzfs", ",", "Pzfs"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.710999431121374*^9, {3.711682243132311*^9, 3.711682248556163*^9}, 
   3.711682292908148*^9, {3.711682450507135*^9, 
   3.7116824752331543`*^9}},ExpressionUUID->"e8baaadb-e84a-4989-b7a9-\
a56261980995"],

Cell[BoxData[
 TemplateBox[{
  "StringJoin","string",
   "\"String expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"fileName\\\", \\\"<>\\\", \
\\\"\\\\\\\"_data.csv\\\\\\\"\\\"}]\\).\"",2,161,20,27567918183901105779,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.71168222492931*^9},ExpressionUUID->"ffff4960-aa0f-40b9-9f6b-25c7435fcd24"],

Cell[BoxData[
 TemplateBox[{
  "Export","chtype",
   "\"First argument \\!\\(\\*RowBox[{\\\"fileName\\\", \\\"<>\\\", \
\\\"\\\\\\\"_data.csv\\\\\\\"\\\"}]\\) is not a valid file specification.\"",
   2,161,21,27567918183901105779,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.711682224936735*^9},ExpressionUUID->"5eb4a68a-9b2f-4196-8b34-\
c0d10b174987"],

Cell[BoxData[
 TemplateBox[{
  "StringJoin","string",
   "\"String expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"fileName\\\", \\\"<>\\\", \
\\\"\\\\\\\"_plot.pdf\\\\\\\"\\\"}]\\).\"",2,162,22,27567918183901105779,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7116822249431887`*^9},ExpressionUUID->"27db073a-f831-4733-b596-\
ffcf67d5f4b6"],

Cell[BoxData[
 TemplateBox[{
  "Export","chtype",
   "\"First argument \\!\\(\\*RowBox[{\\\"fileName\\\", \\\"<>\\\", \
\\\"\\\\\\\"_plot.pdf\\\\\\\"\\\"}]\\) is not a valid file specification.\"",
   2,162,23,27567918183901105779,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7116822249491053`*^9},ExpressionUUID->"ecd02be0-49a1-4786-be13-\
5241dbe38ed0"],

Cell[BoxData[
 TemplateBox[{
  "StringJoin","string",
   "\"String expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"fileName\\\", \\\"<>\\\", \
\\\"\\\\\\\"_params.dat\\\\\\\"\\\"}]\\).\"",2,163,24,27567918183901105779,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.711682224955822*^9},ExpressionUUID->"0d64c021-4bdd-4350-96e5-\
4dc810cf1e34"],

Cell[BoxData[
 TemplateBox[{
  "Save","stream",
   "\"\\!\\(\\*RowBox[{\\\"fileName\\\", \\\"<>\\\", \
\\\"\\\\\\\"_params.dat\\\\\\\"\\\"}]\\) is not a string, SocketObject, \
InputStream[ ], or OutputStream[ ].\"",2,163,25,27567918183901105779,"Local"},
  
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.711682224962866*^9},ExpressionUUID->"0dcf5c1c-12d3-4f2f-84c0-\
0bdefa8da282"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["With spin-bath", "Title",
 CellChangeTimes->{{3.711246437497582*^9, 3.7112464454897118`*^9}, {
  3.7113355912318563`*^9, 
  3.7113355918067713`*^9}},ExpressionUUID->"a99bc2f2-86bf-415b-824c-\
200695c78a42"],

Cell[CellGroupData[{

Cell["Initialisation", "Subsection",
 CellChangeTimes->{{3.711326135259593*^9, 
  3.711326137384762*^9}},ExpressionUUID->"5555a3a4-a36b-46fe-9a16-\
332a95ab16ca"],

Cell[CellGroupData[{

Cell["Simulation parameters", "Subsubsection",
 CellChangeTimes->{{3.711327321484583*^9, 
  3.711327325359797*^9}},ExpressionUUID->"3b9dec0c-67c6-4523-9214-\
2cebd16906f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pulseAmplitude", " ", "=", " ", 
    RowBox[{"7", "*", 
     SuperscriptBox["10", "6"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pulsePhase", " ", "=", " ", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pulseFreqStart", " ", "=", " ", 
    RowBox[{"2.86", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pulseFreqEnd", " ", "=", " ", 
    RowBox[{"2.881", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pulseFreqStep", " ", "=", " ", 
    RowBox[{"1", "*", 
     SuperscriptBox["10", "6"]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"calculations", " ", "=", " ", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "f", ",", " ", "pulseFreqStart", ",", " ", "pulseFreqEnd", ",", " ", 
         "pulseFreqStep"}], "}"}]}], "]"}], " ", "//", " ", "Length"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tStart", " ", "=", " ", "0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Start", "-", 
    RowBox[{"time", " ", "of", " ", 
     RowBox[{"NDSolve", " ", "[", "s", "]"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tEnd", " ", "=", " ", 
    RowBox[{"2", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"End", "-", 
    RowBox[{"time", " ", "of", " ", 
     RowBox[{"NDSolve", " ", "[", "s", "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B0", " ", "=", 
   RowBox[{"0", "*", "513", " ", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"DC", " ", "Applied", " ", 
    RowBox[{"field", " ", "[", "T", "]"}]}], " ", "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]s", "=", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "\[Gamma]e"}], " ", "B0"}], 
     RowBox[{"2", "\[Pi]"}]]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]I", "=", 
    FractionBox[
     RowBox[{"\[Gamma]N", " ", "B0"}], 
     RowBox[{"2", "\[Pi]"}]]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"[", "Hz", "]"}], " ", "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.711327327435595*^9, 3.711327496377437*^9}, {
  3.711327550311452*^9, 
  3.7113275505627604`*^9}},ExpressionUUID->"f29aa76e-534a-403e-ba21-\
039a18730440"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup Hamiltonian", "Subsubsection",
 CellChangeTimes->{{3.711326144009676*^9, 
  3.7113261459847507`*^9}},ExpressionUUID->"fad3373c-a5ae-4d61-86b6-\
c3731b19d88d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"spins", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "1", ",", " ", 
      RowBox[{"1", "/", "2"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]HF", " ", "=", " ", 
    RowBox[{"SpinSpinHamiltonian", "[", "\[IndentingNewLine]", 
     RowBox[{"spins", ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", " ", "\[Rule]", " ", "2"}], ",", " ", "Ahf"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", " ", "\[Rule]", " ", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"Ahf", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "/", "2"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]spinSpin", " ", "=", " ", 
    RowBox[{"SpinSpinHamiltonian", "[", "\[IndentingNewLine]", 
     RowBox[{"spins", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", " ", "\[Rule]", " ", "1"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", "Dzfs"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", "\[Rule]", " ", "2"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "Pzfs"}], "}"}]}], "}"}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]zee", " ", "=", " ", 
    RowBox[{"ZeemanHamiltonian", "[", 
     RowBox[{"spins", ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Omega]s", ",", " ", "\[Omega]I", ",", " ", "0"}], "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]NV", " ", "=", " ", 
    RowBox[{
    "\[ScriptCapitalH]HF", " ", "+", " ", "\[ScriptCapitalH]spinSpin", " ", 
     "+", " ", "\[ScriptCapitalH]zee"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[ScriptCapitalH]C", "[", 
     RowBox[{"f_", ",", " ", "\[Delta]_", ",", " ", "t_"}], "]"}], " ", "=", 
    " ", 
    RowBox[{"pulseAmplitude", "*", " ", 
     RowBox[{"FullHilbertSpaceOperator", "[", " ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"1", "\[Rule]", " ", 
          RowBox[{"SpinMatrixX", "[", "1", "]"}]}], ",", " ", 
         RowBox[{"2", "\[Rule]", " ", 
          RowBox[{"SpinMatrixX", "[", "1", "]"}]}]}], " ", "}"}], ",", " ", 
       RowBox[{
        RowBox[{"2", "spins"}], " ", "+", " ", "1"}]}], " ", "]"}], " ", "*", 
     " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"2", "\[Pi]", " ", "f", " ", "t"}], " ", "+", " ", 
       "\[Delta]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalH]", "[", 
    RowBox[{"f_", ",", " ", "\[Delta]_", ",", " ", "t_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"\[ScriptCapitalH]NV", "  ", "+", " ", 
    RowBox[{"\[ScriptCapitalH]C", "[", 
     RowBox[{"f", ",", " ", "\[Delta]", ",", " ", "t"}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7113266610971823`*^9, 3.7113266983812313`*^9}, {
  3.711326759656721*^9, 3.711326807406846*^9}, {3.71132688780748*^9, 
  3.711326900757473*^9}, {3.711327169610208*^9, 3.711327317259818*^9}, {
  3.711328562691675*^9, 3.711328639167479*^9}, {3.711328690593836*^9, 
  3.711328716767874*^9}, {3.711328793069077*^9, 3.7113288195683937`*^9}, {
  3.711330155551496*^9, 3.7113302703264923`*^9}, {3.711330811180303*^9, 
  3.7113308608554068`*^9}, {3.711330965706061*^9, 3.711330965956944*^9}, {
  3.711331118207323*^9, 3.7113311259314938`*^9}, {3.711332393264576*^9, 
  3.711332402338951*^9}, {3.7113356005571012`*^9, 3.711335600657077*^9}, {
  3.711335632182954*^9, 3.7113356950079527`*^9}, {3.711338333500614*^9, 
  3.7113383539988337`*^9}, {3.711339491606833*^9, 3.71133952685497*^9}, {
  3.711339906209104*^9, 3.711339927507094*^9}, {3.711339959782473*^9, 
  3.711339960207382*^9}},ExpressionUUID->"d583954a-e2a8-4699-9f17-\
3760f23ec445"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial state", "Subsubsection",
 CellChangeTimes->{{3.7113405719102716`*^9, 
  3.71134057401019*^9}},ExpressionUUID->"a1457e51-370c-4239-b25f-\
b37e2251a6c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eig", " ", "=", " ", 
   RowBox[{"Eigensystem", "[", "\[ScriptCapitalH]NV", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groundState", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"eig", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"eig", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"eig", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "}"}], " ", "//", " ", 
    "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"density0", " ", "=", " ", 
   RowBox[{"groundState", " ", ".", " ", 
    RowBox[{"ConjugateTranspose", "[", "groundState", "]"}]}]}], " ", 
  ";"}]}], "Input",
 CellChangeTimes->{{3.711340575038134*^9, 
  3.711340602985878*^9}},ExpressionUUID->"c0f709b3-b491-47fc-aa2e-\
17c72d5d513a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Meta", "Subsubsection",
 CellChangeTimes->{{3.7113304067517138`*^9, 
  3.711330407126807*^9}},ExpressionUUID->"69f00583-2338-46c4-adb1-\
935834ae4aed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fileNamePrefix", " ", "=", " ", 
   RowBox[{"\"\<results/nv_center_simulation\>\"", "  ", "<>", " ", 
    RowBox[{"StringReplace", "[", " ", 
     RowBox[{
      RowBox[{"DateString", "[", "\"\<ISODateTime\>\"", "]"}], ",", " ", 
      RowBox[{"\"\<:\>\"", " ", "\[Rule]", " ", "\"\<.\>\""}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comments", " ", "=", " ", 
   RowBox[{"StringRiffle", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Pulse that acts on both nuclear spin and electron spin\>\"", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<B0=``T\>\"", ",", "B0"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<Frequency Resolution=``Hz\>\"", ",", " ", "pulseFreqStep"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<Pulse amplitude=``Hz\>\"", ",", " ", "pulseAmplitude"}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], ",", " ", "\"\<. \>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7113304083285027`*^9, 
  3.711330448428396*^9}},ExpressionUUID->"466567d4-59cd-4466-84f4-\
dfac10c4feaa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results", "Subsection",
 CellChangeTimes->{{3.7113349490780897`*^9, 
  3.711334949853162*^9}},ExpressionUUID->"b0b4fffa-0752-41cb-8df5-\
88548a26b4ed"],

Cell[CellGroupData[{

Cell["Energy spectrum of the unperturbed Hamiltonian", "Subsubsection",
 CellChangeTimes->{{3.711334963953167*^9, 
  3.7113349865784607`*^9}},ExpressionUUID->"71c0add9-2f61-4f09-9f21-\
63005167a562"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NVCenterEnergySpectrum", "[", 
    RowBox[{"\[ScriptCapitalH]NV", ",", " ", "spins"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], " "}]], "Input",
 CellChangeTimes->{
  3.711334974728861*^9, 3.711335007730961*^9, {3.7113390624293137`*^9, 
   3.711339066227207*^9}, {3.7113396269068203`*^9, 3.711339664930314*^9}, {
   3.711339795431065*^9, 
   3.711339800056027*^9}},ExpressionUUID->"1713a1d8-fe96-42d9-a4fc-\
600027e407ae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["\<\"E\"\>",
       StripOnInput->False,
       FontWeight->Bold], 
      StyleBox["\<\"|\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(E\\)]\\)\
\[RightAngleBracket]\"\>",
       StripOnInput->False,
       FontWeight->Bold], 
      StyleBox["\<\"\[LeftAngleBracket]\\!\\(\\*SubscriptBox[\\(J\\), \
\\(z\\)]\\)\[RightAngleBracket]\"\>",
       StripOnInput->False,
       FontWeight->Bold]},
     {"\<\"---\"\>", "\<\"---\"\>", "\<\"---\"\>"},
     {"2.870541737345502`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.00040022339702266985`"}], " ", 
         StyleBox["\<\"|1,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0002664371540399557`", " ", 
         StyleBox["\<\"|0,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007304158758722479`", " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "5.551115123125783`*^-17"}], " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "5.209591438792849`*^-17"}], " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.000144513424737824`"}], " ", 
         StyleBox["\<\"|-1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.9999996072204198`"}], " ", 
         StyleBox["\<\"|-1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "0.9999997479483457`"}]},
     {"2.870541737345501`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.804833632168121`*^-17"}], " ", 
         StyleBox["\<\"|1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "4.210571363615749`*^-17"}], " ", 
         StyleBox["\<\"|1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.9999996072204197`"}], " ", 
         StyleBox["\<\"|1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0001445134247469726`"}], " ", 
         StyleBox["\<\"|1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007304158758724699`", " ", 
         StyleBox["\<\"|0,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.00026643715403993555`", " ", 
         StyleBox["\<\"|0,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"5.726628620465766`*^-21", " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"1.6170803259735197`*^-20", " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0004002233970578084`"}], " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "0.9999997479483455`"},
     {"2.869461534278686`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.0007306087000326089`"}], " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999997288268277`", " ", 
         StyleBox["\<\"|-1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.00009250512551234624`", " ", 
         StyleBox["\<\"|-1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "1.000000008557198`"}]},
     {"2.869461534278684`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.00009250512532910093`"}], " ", 
         StyleBox["\<\"|1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.9999997288268279`"}], " ", 
         StyleBox["\<\"|1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "4.913648714934037`*^-17"}], " ", 
         StyleBox["\<\"|1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "4.613791180804999`*^-17"}], " ", 
         StyleBox["\<\"|1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007306087000325318`", " ", 
         StyleBox["\<\"|0,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "1.2746042453990877`*^-19"}], " ", 
         StyleBox["\<\"|0,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"2.240979210815856`*^-33", " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "3.0045903336605817`*^-33"}], " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"6.39151056345213`*^-17", " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "1.0000000085571983`"},
     {"2.8677517425454636`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.9999986025776798`"}], " ", 
         StyleBox["\<\"|1,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007332155290579179`", " ", 
         StyleBox["\<\"|0,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.00026554533225128796`", " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "1.1102230246251565`*^-16"}], " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"1.0083080204115191`*^-17", " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0014234002512696043`"}], " ", 
         StyleBox["\<\"|-1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0004008180100050218`", " ", 
         StyleBox["\<\"|-1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "2.3116940062483267`*^-7"}]},
     {"2.867751742545463`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4.2043086149829216`*^-17"}], " ", 
         StyleBox["\<\"|1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"1.3907335564204792`*^-16", " ", 
         StyleBox["\<\"|1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0004008180100402384`"}], " ", 
         StyleBox["\<\"|1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0014234002513305866`", " ", 
         StyleBox["\<\"|1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"2.220446049250313`*^-16", " ", 
         StyleBox["\<\"|0,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0002655453322516488`"}], " ", 
         StyleBox["\<\"|0,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0007332155290579618`"}], " ", 
         StyleBox["\<\"|0,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "1.7377241440556626`*^-17"}], " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"5.2992760107145204`*^-17", " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999986025776793`", " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "2.311694006532552`*^-7"},
     {"2.866671536098212`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"4.176931721867234`*^-17", " ", 
         StyleBox["\<\"|1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "7.950663871727308`*^-17"}], " ", 
         StyleBox["\<\"|1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.00014413791717285637`"}], " ", 
         StyleBox["\<\"|1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999987082037937`", " ", 
         StyleBox["\<\"|1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"2.168404344971009`*^-19", " ", 
         StyleBox["\<\"|1,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "1.1102230246251565`*^-16"}], " ", 
         StyleBox["\<\"|0,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"4.841024401347482`*^-7", " ", 
         StyleBox["\<\"|0,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0007314743939318207`"}], " ", 
         StyleBox["\<\"|0,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"7.078011989313142`*^-20", " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"1.5658995267817387`*^-19", " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0014239943754149609`"}], " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "2.0775973522101747`*^-8"},
     {"2.866671536098212`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.0014239943753548015`"}], " ", 
         StyleBox["\<\"|1,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0007314743939318695`"}], " ", 
         StyleBox["\<\"|0,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"4.841024397149994`*^-7", " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "2.168404344971009`*^-19"}], " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999987082037939`", " ", 
         StyleBox["\<\"|-1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.00014413791716377978`"}], " ", 
         StyleBox["\<\"|-1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "2.077597351948478`*^-8"}]},
     {"2.863430203268498`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.0002661713476088652`"}], " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.00009269961407793478`"}], " ", 
         StyleBox["\<\"|-1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999999602797969`", " ", 
         StyleBox["\<\"|-1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "1.9999999205595953`"}]},
     {"2.863430203268497`*^9", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.9999999602797968`"}], " ", 
         StyleBox["\<\"|1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.00009269961389468673`", " ", 
         StyleBox["\<\"|1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "3.782531505082485`*^-18"}], " ", 
         StyleBox["\<\"|1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "3.532552653709827`*^-18"}], " ", 
         StyleBox["\<\"|1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "7.703719777548943`*^-34"}], " ", 
         StyleBox["\<\"|1,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0002661713476089998`", " ", 
         StyleBox["\<\"|0,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "6.436687261641394`*^-20"}], " ", 
         StyleBox["\<\"|0,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "2.7794232963023826`*^-35"}], " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"5.0895642234045595`*^-18", " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "7.703719777548943`*^-34"}], " ", 
         StyleBox["\<\"|-1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "1.9999999205595949`"},
     {"2.86235`*^9", 
      RowBox[{"{", 
       RowBox[{"1.`", " ", 
        StyleBox["\<\"|1,1,0.5\[RightAngleBracket]\"\>",
         StripOnInput->False,
         FontWeight->Bold]}], "}"}], "2.`"},
     {"2.86235`*^9", 
      RowBox[{"{", 
       RowBox[{"1.`", " ", 
        StyleBox["\<\"|-1,-1,-0.5\[RightAngleBracket]\"\>",
         StripOnInput->False,
         FontWeight->Bold]}], "}"}], 
      RowBox[{"-", "2.`"}]},
     {
      RowBox[{"-", "4.951737547187328`*^6"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.999999697681825`", " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007305840487987769`", " ", 
         StyleBox["\<\"|-1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0002662390025748714`", " ", 
         StyleBox["\<\"|-1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "1.0000000708832066`"}]},
     {
      RowBox[{"-", "4.951737547183514`*^6"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.0002662390025748499`", " ", 
         StyleBox["\<\"|1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007305840487986749`", " ", 
         StyleBox["\<\"|1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"2.9893865161056965`*^-10", " ", 
         StyleBox["\<\"|1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"6.76141528565264`*^-14", " ", 
         StyleBox["\<\"|1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999996976817409`", " ", 
         StyleBox["\<\"|0,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"4.092974515839884`*^-7", " ", 
         StyleBox["\<\"|0,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"9.230503802892858`*^-11", " ", 
         StyleBox["\<\"|0,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "8.807758475318631`*^-27"}], " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"3.483266497034669`*^-27", " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"1.0887460818358987`*^-10", " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "1.000000070883206`"},
     {
      RowBox[{"-", "4.951736916864507`*^6"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.0897098102459499`*^-10"}], " ", 
         StyleBox["\<\"|1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "2.9902628743134014`*^-10"}], " ", 
         StyleBox["\<\"|1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007303695259385749`", " ", 
         StyleBox["\<\"|1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"1.6492190370911422`*^-7", " ", 
         StyleBox["\<\"|1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "4.092974620339973`*^-7"}], " ", 
         StyleBox["\<\"|0,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999996724713228`", " ", 
         StyleBox["\<\"|0,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0002255206309669321`", " ", 
         StyleBox["\<\"|0,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "1.2136084415700236`*^-20"}], " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "4.500919202960811`*^-22"}], " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.00026600348273586594`", " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "0.9999998783825649`"},
     {
      RowBox[{"-", "4.9517369168634415`*^6"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.0002660034827355222`"}], " ", 
         StyleBox["\<\"|1,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.00022552063096636932`"}], " ", 
         StyleBox["\<\"|0,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.9999996724714065`"}], " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"2.3527187142935446`*^-17", " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "5.288196096298048`*^-17"}], " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "1.6492190421220427`*^-7"}], " ", 
         StyleBox["\<\"|-1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.0007303695259386972`"}], " ", 
         StyleBox["\<\"|-1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "0.9999998783825648`"}]},
     {
      RowBox[{"-", "3279.0723161697388`"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"3.1467498706263082`*^-21", " ", 
         StyleBox["\<\"|1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"8.613614188295471`*^-21", " ", 
         StyleBox["\<\"|1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.00026587317560151897`", " ", 
         StyleBox["\<\"|1,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007325560122588125`", " ", 
         StyleBox["\<\"|1,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"1.1763593571467723`*^-17", " ", 
         StyleBox["\<\"|0,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.00022590964980801517`"}], " ", 
         StyleBox["\<\"|0,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999994027457652`", " ", 
         StyleBox["\<\"|0,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"1.5057493551038704`*^-20", " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"9.07833400916311`*^-22", " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007322199714546011`", " ", 
         StyleBox["\<\"|-1,1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], "1.217237153808162`*^-7"},
     {
      RowBox[{"-", "3279.072302341461`"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.0007322199714546028`", " ", 
         StyleBox["\<\"|1,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.9999994027457652`", " ", 
         StyleBox["\<\"|0,0,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "0.00022590964980738964`"}], " ", 
         StyleBox["\<\"|0,-1,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{
         RowBox[{"-", "1.0842021724855044`*^-19"}], " ", 
         StyleBox["\<\"|0,-1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.0007325560122588149`", " ", 
         StyleBox["\<\"|-1,1,-0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}], ",", 
        RowBox[{"0.00026587317560152016`", " ", 
         StyleBox["\<\"|-1,0,0.5\[RightAngleBracket]\"\>",
          StripOnInput->False,
          FontWeight->Bold]}]}], "}"}], 
      RowBox[{"-", "1.217237153805342`*^-7"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.711334976669321*^9, 3.71133500891424*^9, 3.7113352315172*^9, {
   3.711335704527123*^9, 3.711335732219458*^9}, {3.7113357626234913`*^9, 
   3.7113357684892282`*^9}, 3.711337210458088*^9, 3.711338362770653*^9, {
   3.711339063913186*^9, 3.711339066516954*^9}, 3.7113395635953913`*^9, {
   3.7113396302503147`*^9, 3.711339662780504*^9}, {3.711339740903737*^9, 
   3.7113397570604486`*^9}, {3.71133979714233*^9, 3.71133980056959*^9}, 
   3.71142564667187*^9, 
   3.711679961286089*^9},ExpressionUUID->"8e3d8275-a6ff-497a-984a-\
062478e7955a"]
}, Open  ]]
}, Open  ]],

Cell["Simulation results", "Subsubsection",
 CellChangeTimes->{{3.7113406169354763`*^9, 
  3.711340620085168*^9}},ExpressionUUID->"1816a0da-5dc2-4b4f-b68f-\
6f48c5c7c769"]
}, Open  ]]
}, Closed]]
},
WindowSize->{1915, 1027},
WindowMargins->{{0, Automatic}, {1, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 449, 11, 79, "Input", "ExpressionUUID" -> \
"610f21b9-8da0-4c10-80f2-3ec1ae10d782"],
Cell[CellGroupData[{
Cell[1032, 35, 167, 3, 93, "Title", "ExpressionUUID" -> \
"17c79617-3f48-40ff-b1ce-b7c110d0d8fb"],
Cell[1202, 40, 439, 12, 78, "Text", "ExpressionUUID" -> \
"5b33cbac-42c9-42c1-b6d5-8dacdde316ab"],
Cell[1644, 54, 426, 9, 99, "Text", "ExpressionUUID" -> \
"e4bb5524-2509-4001-87ac-d45eb8ab1907"],
Cell[CellGroupData[{
Cell[2095, 67, 159, 3, 66, "Chapter", "ExpressionUUID" -> \
"19fded08-3617-4157-ba0a-09242c9a372f"],
Cell[CellGroupData[{
Cell[2279, 74, 215, 4, 65, "Section", "ExpressionUUID" -> \
"dee25e60-2aa0-4c81-a7a7-edd5bf678d92"],
Cell[2497, 80, 2576, 75, 166, "Input", "ExpressionUUID" -> \
"25e65bac-7b78-4e63-bb19-0c600059ffd8"]
}, Closed]],
Cell[CellGroupData[{
Cell[5110, 160, 156, 3, 51, "Section", "ExpressionUUID" -> \
"33751f26-5118-427d-bd1d-36bd71e4f594"],
Cell[CellGroupData[{
Cell[5291, 167, 188, 3, 36, "Subsubsection", "ExpressionUUID" -> \
"25d73bb2-3e52-43fc-8a4b-6fc858a85465"],
Cell[5482, 172, 840, 24, 37, "Text", "ExpressionUUID" -> \
"795b5723-e2c3-4a8c-98c1-503eb98ddfe7"],
Cell[6325, 198, 701, 20, 57, "Input", "ExpressionUUID" -> \
"e5a58848-be0e-4033-b4f8-24ae9bf1d61d"]
}, Closed]],
Cell[CellGroupData[{
Cell[7063, 223, 301, 4, 30, "Subsubsection", "ExpressionUUID" -> \
"86b46845-37ea-42fb-b575-376c9dc7b175"],
Cell[7367, 229, 1250, 36, 59, "Text", "ExpressionUUID" -> \
"e561a6a7-bf75-4857-90dc-9764ea1cfb32"],
Cell[8620, 267, 3916, 86, 305, "Input", "ExpressionUUID" -> \
"635c7b3f-cbfc-4ed4-b2a8-549fd15a5ae3"]
}, Closed]],
Cell[CellGroupData[{
Cell[12573, 358, 146, 3, 30, "Subsubsection", "ExpressionUUID" -> \
"5301936c-f3f8-4ffd-8c79-df6132f5e5d9"],
Cell[12722, 363, 1397, 35, 112, "Input", "ExpressionUUID" -> \
"01b676cd-188a-4f94-b281-69c60a5bc0ee"]
}, Closed]],
Cell[CellGroupData[{
Cell[14156, 403, 170, 3, 30, "Subsubsection", "ExpressionUUID" -> \
"303ecb3b-13b4-4715-b6d7-3d0096134513"],
Cell[14329, 408, 1432, 36, 112, "Input", "ExpressionUUID" -> \
"043b02bc-cde3-498c-bea6-9b6331b83e5a"]
}, Closed]],
Cell[CellGroupData[{
Cell[15798, 449, 168, 3, 30, "Subsubsection", "ExpressionUUID" -> \
"91fa8865-d8cd-4e67-823b-c5a42f667ca6"],
Cell[15969, 454, 943, 21, 86, "Input", "ExpressionUUID" -> \
"16641524-6787-4236-8a48-029b6eddd391"]
}, Closed]],
Cell[CellGroupData[{
Cell[16949, 480, 170, 3, 30, "Subsubsection", "ExpressionUUID" -> \
"6be122a3-c5c7-40f9-9b25-b437d78d96c3"],
Cell[17122, 485, 371, 11, 39, "Text", "ExpressionUUID" -> \
"c245072e-35a8-49f6-8415-ca0f429521fc"],
Cell[17496, 498, 1460, 41, 80, "Input", "ExpressionUUID" -> \
"bd481476-810a-4014-8d79-99eb53767c82"]
}, Closed]],
Cell[CellGroupData[{
Cell[18993, 544, 237, 4, 30, "Subsubsection", "ExpressionUUID" -> \
"34dee551-86ae-4a59-8ceb-e32097ee74ba"],
Cell[19233, 550, 1027, 30, 150, "Text", "ExpressionUUID" -> \
"bfc14f1d-fd16-4a23-bd9e-54ed6d012191"],
Cell[20263, 582, 6915, 146, 686, "Input", "ExpressionUUID" -> \
"e513bfb5-39ed-492d-a7e2-e9215bf46043"]
}, Closed]],
Cell[CellGroupData[{
Cell[27215, 733, 239, 4, 30, "Subsubsection", "ExpressionUUID" -> \
"280f5d62-9654-43c9-b642-57158dcb82dd"],
Cell[27457, 739, 245, 4, 33, "Text", "ExpressionUUID" -> \
"32702ccc-a7fc-433f-8ebf-e8df3520487c"],
Cell[27705, 745, 1152, 27, 80, "Input", "ExpressionUUID" -> \
"d1ecf4e6-9311-46e0-b8ed-43196b4fcf77"]
}, Closed]],
Cell[CellGroupData[{
Cell[28894, 777, 448, 6, 30, "Subsubsection", "ExpressionUUID" -> \
"1b8b7d2e-2be2-4995-a67c-22798fcb400e"],
Cell[29345, 785, 119, 3, 33, "Text", "ExpressionUUID" -> \
"a71c1a2f-e2f1-4e8b-8b36-9bead87b72ce"],
Cell[29467, 790, 8814, 197, 988, "Input", "ExpressionUUID" -> \
"6706f073-dc9c-4504-bd25-78b5208faf1e"]
}, Closed]],
Cell[CellGroupData[{
Cell[38318, 992, 188, 3, 30, "Subsubsection", "ExpressionUUID" -> \
"e391d773-8db5-4b46-a4a5-474af753f2a4"],
Cell[38509, 997, 764, 22, 37, "Text", "ExpressionUUID" -> \
"c5d67a90-77e2-4dc2-923b-30b4510f0e28"],
Cell[39276, 1021, 743, 20, 113, "Input", "ExpressionUUID" -> \
"e6f3ee31-b05f-43a9-b331-75dff12fa8e0"]
}, Closed]],
Cell[CellGroupData[{
Cell[40056, 1046, 352, 7, 30, "Subsubsection", "ExpressionUUID" -> \
"7e684e91-45bf-4108-aa9b-43dd3b243eef"],
Cell[40411, 1055, 144, 3, 33, "Text", "ExpressionUUID" -> \
"78e0107b-2ec0-4b9b-a8ce-5fa2857f329e"],
Cell[40558, 1060, 12878, 282, 1282, "Input", "ExpressionUUID" -> \
"1b0f4fbd-7283-4357-9fc4-5f9f4122e081"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53509, 1350, 206, 4, 93, "Title", "ExpressionUUID" -> \
"86ac2eed-bad9-42f2-9914-4d2eb50a153a"],
Cell[CellGroupData[{
Cell[53740, 1358, 162, 3, 44, "Subsection", "ExpressionUUID" -> \
"9230f74c-3079-4432-a627-3706e53bbdd3"],
Cell[CellGroupData[{
Cell[53927, 1365, 172, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"5cefe403-c097-4393-9bdc-52d4991e7e46"],
Cell[CellGroupData[{
Cell[54124, 1372, 3460, 92, 442, "Input", "ExpressionUUID" -> \
"a40b7a0c-be1c-4915-96c3-03848366f46e"],
Cell[57587, 1466, 804, 14, 24, "Print", "ExpressionUUID" -> \
"b293937c-0eba-44fe-a718-aa2433693ab6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58440, 1486, 170, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"da94ca88-ba88-458b-925e-d216f9f64e04"],
Cell[58613, 1491, 4358, 101, 530, "Input", "ExpressionUUID" -> \
"db128fd9-f2ef-4e2b-8cb1-82a1b52e073e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63008, 1597, 165, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"27086003-bba5-40f5-9ddd-a9a3b6912713"],
Cell[63176, 1602, 1131, 32, 80, "Input", "ExpressionUUID" -> \
"99185e00-5b28-41b1-902a-42d8fef6e39e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64344, 1639, 157, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"fe58d293-8aa8-40f4-ac76-1e5d82fb5a0e"],
Cell[64504, 1644, 1302, 30, 171, "Input", "ExpressionUUID" -> \
"1ed51bf3-7eb6-43fc-9035-bf613a6ef044"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65855, 1680, 164, 3, 44, "Subsection", "ExpressionUUID" -> \
"400df2bd-2225-447a-820d-ca2f16c7d59e"],
Cell[CellGroupData[{
Cell[66044, 1687, 1179, 28, 103, "Input", "ExpressionUUID" -> \
"2ba5b246-1012-4bd5-854b-812609a1f26b"],
Cell[67226, 1717, 329, 7, 400, "Print", "ExpressionUUID" -> \
"bb6bdfea-d9ab-40da-b3c0-2e448eed746d"],
Cell[67558, 1726, 479, 10, 23, "Message", "ExpressionUUID" -> \
"9c5e872e-4940-4f41-92df-69c4cb4455fc"],
Cell[68040, 1738, 850, 16, 33, "Message", "ExpressionUUID" -> \
"cb992721-b67d-4966-bbc2-741ee759c246"],
Cell[68893, 1756, 479, 10, 23, "Message", "ExpressionUUID" -> \
"ba88c472-db4c-47a5-967d-116f19a1776d"],
Cell[69375, 1768, 846, 15, 51, "Message", "ExpressionUUID" -> \
"eba047d1-7e9c-466f-b6b1-e144be7536b9"],
Cell[70224, 1785, 481, 10, 23, "Message", "ExpressionUUID" -> \
"043d4002-0cb6-4c20-b14a-a6ee3709a8f8"],
Cell[70708, 1797, 454, 9, 23, "Message", "ExpressionUUID" -> \
"27c548e1-2fbd-4c62-861b-cce547ffb0ba"],
Cell[71165, 1808, 850, 15, 51, "Message", "ExpressionUUID" -> \
"7f9bbe16-dea3-4c29-9e42-21724692830d"],
Cell[72018, 1825, 450, 9, 23, "Message", "ExpressionUUID" -> \
"fbf3faf6-14c4-424c-9dce-5642e138f323"],
Cell[72471, 1836, 365, 8, 24, "PrintTemporary", "ExpressionUUID" -> \
"b5a76549-92fe-45a3-8a7d-f65953ea9e5f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72885, 1850, 157, 3, 44, "Subsection", "ExpressionUUID" -> \
"8214d20f-0e1b-43da-836e-a05559a345ef"],
Cell[CellGroupData[{
Cell[73067, 1857, 199, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"429b76d5-4d40-431e-966a-b04ef682fe2a"],
Cell[CellGroupData[{
Cell[73291, 1864, 454, 10, 34, "Input", "ExpressionUUID" -> \
"a8890a55-1f87-449b-b31d-a5ea7393b3d4"],
Cell[73748, 1876, 5306, 142, 267, "Output", "ExpressionUUID" -> \
"cd260d02-e79d-4dee-b601-e54cb8024258"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79103, 2024, 169, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"6ee10d68-549c-4163-8cec-7e3d2c17f02d"],
Cell[CellGroupData[{
Cell[79297, 2031, 787, 19, 34, "Input", "ExpressionUUID" -> \
"0df7c1e8-b417-43ad-8746-bd500ceaf0a8"],
Cell[80087, 2052, 2171, 51, 316, "Output", "ExpressionUUID" -> \
"0a410159-5932-4e64-9b80-cd4f8255dd7e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82307, 2109, 171, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"cbf8282b-f8a2-48ff-b963-e2f233ebfe31"],
Cell[CellGroupData[{
Cell[82503, 2116, 1355, 33, 125, "Input", "ExpressionUUID" -> \
"e8baaadb-e84a-4989-b7a9-a56261980995"],
Cell[83861, 2151, 400, 9, 23, "Message", "ExpressionUUID" -> \
"ffff4960-aa0f-40b9-9f6b-25c7435fcd24"],
Cell[84264, 2162, 383, 9, 23, "Message", "ExpressionUUID" -> \
"5eb4a68a-9b2f-4196-8b34-c0d10b174987"],
Cell[84650, 2173, 405, 10, 23, "Message", "ExpressionUUID" -> \
"27db073a-f831-4733-b596-ffcf67d5f4b6"],
Cell[85058, 2185, 385, 9, 23, "Message", "ExpressionUUID" -> \
"ecd02be0-49a1-4786-be13-5241dbe38ed0"],
Cell[85446, 2196, 405, 10, 23, "Message", "ExpressionUUID" -> \
"0d64c021-4bdd-4350-96e5-4dc810cf1e34"],
Cell[85854, 2208, 401, 10, 23, "Message", "ExpressionUUID" -> \
"0dcf5c1c-12d3-4f2f-84c0-0bdefa8da282"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86328, 2226, 212, 4, 93, "Title", "ExpressionUUID" -> \
"a99bc2f2-86bf-415b-824c-200695c78a42"],
Cell[CellGroupData[{
Cell[86565, 2234, 162, 3, 44, "Subsection", "ExpressionUUID" -> \
"5555a3a4-a36b-46fe-9a16-332a95ab16ca"],
Cell[CellGroupData[{
Cell[86752, 2241, 172, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"3b9dec0c-67c6-4523-9214-2cebd16906f2"],
Cell[86927, 2246, 3046, 92, 397, "Input", "ExpressionUUID" -> \
"f29aa76e-534a-403e-ba21-039a18730440"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90010, 2343, 170, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"fad3373c-a5ae-4d61-86b6-c3731b19d88d"],
Cell[90183, 2348, 4451, 107, 530, "Input", "ExpressionUUID" -> \
"d583954a-e2a8-4699-9f17-3760f23ec445"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94671, 2460, 165, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"a1457e51-370c-4239-b25f-b37e2251a6c5"],
Cell[94839, 2465, 1131, 32, 80, "Input", "ExpressionUUID" -> \
"c0f709b3-b491-47fc-aa2e-17c72d5d513a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96007, 2502, 157, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"69f00583-2338-46c4-adb1-935834ae4aed"],
Cell[96167, 2507, 1302, 30, 193, "Input", "ExpressionUUID" -> \
"466567d4-59cd-4466-84f4-dfac10c4feaa"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97518, 2543, 157, 3, 44, "Subsection", "ExpressionUUID" -> \
"b0b4fffa-0752-41cb-8df5-88548a26b4ed"],
Cell[CellGroupData[{
Cell[97700, 2550, 199, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"71c0add9-2f61-4f09-9f21-63005167a562"],
Cell[CellGroupData[{
Cell[97924, 2557, 476, 11, 34, "Input", "ExpressionUUID" -> \
"1713a1d8-fe96-42d9-a4fc-600027e407ae"],
Cell[98403, 2570, 26521, 655, 70, "Output", "ExpressionUUID" -> \
"8e3d8275-a6ff-497a-984a-062478e7955a"]
}, Open  ]]
}, Open  ]],
Cell[124951, 3229, 171, 3, 35, "Subsubsection", "ExpressionUUID" -> \
"1816a0da-5dc2-4b4f-b68f-6f48c5c7c769"]
}, Open  ]]
}, Closed]]
}
]
*)

